<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 How do LMM’s work? | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 How do LMM’s work? | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 How do LMM’s work? | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="fixed-and-random-effects.html"/>
<link rel="next" href="how-do-i-implement-lmms-in-r.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>Linear mixed models (LMMs)</b></span></li>
<li class="chapter" data-level="3" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>3</b> Overview</a></li>
<li class="chapter" data-level="4" data-path="what-is-a-lmm-and-why-should-i-care.html"><a href="what-is-a-lmm-and-why-should-i-care.html"><i class="fa fa-check"></i><b>4</b> What is a LMM and why should I care?</a></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-dataset.html"><a href="introduction-to-the-dataset.html"><i class="fa fa-check"></i><b>5</b> Introduction to the dataset</a></li>
<li class="chapter" data-level="6" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html"><i class="fa fa-check"></i><b>6</b> How do I analyze this dataset?</a><ul>
<li class="chapter" data-level="6.1" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#run-many-separate-analyses"><i class="fa fa-check"></i><b>6.1</b> Run many separate analyses</a></li>
<li class="chapter" data-level="6.2" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#run-one-lumped-analysis"><i class="fa fa-check"></i><b>6.2</b> Run one lumped analysis</a></li>
<li class="chapter" data-level="6.3" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#fit-a-lmm"><i class="fa fa-check"></i><b>6.3</b> Fit a LMM</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html"><i class="fa fa-check"></i><b>7</b> Fixed and Random Effects</a><ul>
<li class="chapter" data-level="7.1" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html#fixed-effect"><i class="fa fa-check"></i><b>7.1</b> Fixed effect</a></li>
<li class="chapter" data-level="7.2" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html#random-effect"><i class="fa fa-check"></i><b>7.2</b> Random effect</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html"><i class="fa fa-check"></i><b>8</b> How do LMM’s work?</a><ul>
<li class="chapter" data-level="8.1" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html#intercepts-andor-slopes-are-allowed-to-vary-by-lake-and-species"><i class="fa fa-check"></i><b>8.1</b> Intercepts and/or slopes are allowed to vary by lake and species</a></li>
<li class="chapter" data-level="8.2" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html#intercepts-slopes-and-associated-confidence-intervals-are-adjusted-to-account-for-the-structure-of-data"><i class="fa fa-check"></i><b>8.2</b> Intercepts, slopes, and associated confidence intervals are adjusted to account for the structure of data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html"><i class="fa fa-check"></i><b>9</b> How do I implement LMM’s in R?</a><ul>
<li class="chapter" data-level="9.1" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#the-mixed-model-protocol-in-r"><i class="fa fa-check"></i><b>9.1</b> The mixed model protocol in R:</a></li>
<li class="chapter" data-level="9.2" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#a-priori-model-building-and-data-exploration"><i class="fa fa-check"></i><b>9.2</b> A priori model building and data exploration</a></li>
<li class="chapter" data-level="9.3" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#coding-potential-models-and-model-selection"><i class="fa fa-check"></i><b>9.3</b> Coding potential models and model selection</a></li>
<li class="chapter" data-level="9.4" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#model-validation"><i class="fa fa-check"></i><b>9.4</b> Model validation</a></li>
<li class="chapter" data-level="9.5" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#interpreting-results-and-visualizing-the-model"><i class="fa fa-check"></i><b>9.5</b> Interpreting results and visualizing the model</a></li>
<li class="chapter" data-level="9.6" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#thought-experiment"><i class="fa fa-check"></i><b>9.6</b> Thought Experiment</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear mixed models (GLMMs)</b></span></li>
<li class="chapter" data-level="10" data-path="generalized-linear-mixed-models-glmms.html"><a href="generalized-linear-mixed-models-glmms.html"><i class="fa fa-check"></i><b>10</b> Generalized linear mixed models (GLMMs)</a></li>
<li class="chapter" data-level="11" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html"><i class="fa fa-check"></i><b>11</b> Structure in dataset</a><ul>
<li class="chapter" data-level="11.1" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#poisson-glmm"><i class="fa fa-check"></i><b>11.1</b> Poisson GLMM</a></li>
<li class="chapter" data-level="11.2" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#negative-binomial-poisson-gamma-glmm"><i class="fa fa-check"></i><b>11.2</b> Negative binomial (Poisson-gamma) GLMM</a></li>
<li class="chapter" data-level="11.3" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#poisson-lognormal-glmm"><i class="fa fa-check"></i><b>11.3</b> Poisson-lognormal GLMM</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="random-intercepts.html"><a href="random-intercepts.html"><i class="fa fa-check"></i><b>12</b> Random intercepts</a><ul>
<li class="chapter" data-level="12.1" data-path="random-intercepts.html"><a href="random-intercepts.html#parameter-plots"><i class="fa fa-check"></i><b>12.1</b> Parameter plots</a></li>
<li class="chapter" data-level="12.2" data-path="random-intercepts.html"><a href="random-intercepts.html#random-intercept-plots"><i class="fa fa-check"></i><b>12.2</b> Random intercept plots</a></li>
<li class="chapter" data-level="12.3" data-path="random-intercepts.html"><a href="random-intercepts.html#random-slopes"><i class="fa fa-check"></i><b>12.3</b> Random slopes</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="final-model.html"><a href="final-model.html"><i class="fa fa-check"></i><b>13</b> Final model</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="14" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>14</b> Summary</a></li>
<li class="chapter" data-level="15" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>15</b> Additional resources</a></li>
<li class="chapter" data-level="16" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>16</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="how-do-lmms-work" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> How do LMM’s work?</h1>
<div id="intercepts-andor-slopes-are-allowed-to-vary-by-lake-and-species" class="section level2">
<h2><span class="header-section-number">8.1</span> Intercepts and/or slopes are allowed to vary by lake and species</h2>
<p>In LMM’s allowing intercepts and/or slopes to vary by certain factors
(random effects) simply means you assume they come from a normal
distribution. A mean and standard deviation of that distribution are
estimated based on your data. The most likely intercepts and slopes from
that distribution are then fit by optimization (ex. maximum likelihood
or restricted maximum likelihood).</p>
<p><strong>Intercepts</strong></p>
<p>In the case of species only a mean and standard deviation are estimated
for the distribution of species intercepts instead of three separate
species intercepts. The mean of this distribution is the ‘species level
model’. In this example, we only have three species. In general, the
more levels you have for a given factor, the more accurately the
parameters of the distribution can be estimated (three may be a little
low for estimating a mean and standard deviation but it makes simpler
graphs!). When you will implement LMM’s in R, note that the intercept
in the summary is the species level intercept (i.e. the mean of all
random intercepts).</p>
<p><img src="images/fig_7_w5.png" width="600" /></p>
<p>Likewise for lake only mean and standard deviation of lake intercepts
are estimated saving you the need to estimate 6 different lake intercept
parameters. This saves degrees of freedom as less parameter estimates
are needed given the amount of data.</p>
<p><img src="images/fig_8_w5.png" width="600" /></p>
<p><strong>Slopes</strong></p>
<p>The same concept is used for allowing slopes to vary by a given factor
(random effect). This is a little harder to visualize than the
intercepts. In the case of species only a mean and standard deviation of
slope parameters are estimated instead of three separate slopes. Again,
when you will implement LMM’s in R, the slope in the summary is the
species level slope.</p>
<p><img src="images/fig_9_w5.png" width="600" /></p>
</div>
<div id="intercepts-slopes-and-associated-confidence-intervals-are-adjusted-to-account-for-the-structure-of-data" class="section level2">
<h2><span class="header-section-number">8.2</span> Intercepts, slopes, and associated confidence intervals are adjusted to account for the structure of data</h2>
<p>If a certain species or lake is data poor like in the example below (we
have a balanced design so not the case in our scenario) it will rely
more heavily on the group level model for the intercept and slope in
that species or lake.</p>
<p><img src="images/fig_12_w5.png" width="600" /></p>
<p>Confidence intervals of intercepts and slopes are adjusted to account
for pseudoreplication based on the <strong>intraclass correlation coefficient
(ICC)</strong> - How much variation is there among groups versus within groups?
This determines your <strong>effective sample size</strong> - An adjusted sample
sized based on how correlated the data within groups are.</p>
<p><strong>High ICC</strong></p>
<p><img src="images/fig_10_w5.png" width="400" /></p>
<p>In this scenario the LMM will treat points within lake more like an
overall mean because they are highly correlated. Therefore, the
effective sample size will be smaller leading to larger confidence
intervals around your slope and intercept parameters.</p>
<p><strong>Low ICC</strong></p>
<p><img src="images/fig_11_w5.png" width="400" /></p>
<p>In this scenario the LMM will treat points within lake more
independently because things are less correlated within groups compared
to among groups. Therefore the effective sample size will be larger
leading to smaller confidence intervals around your slope and intercept
parameters.</p>
<hr />
<p><strong>CHALLENGE 2</strong></p>
<p>For your second challenge answer these two questions with your
neighbours. How will the ICC and confidence intervals be affected in
these two scenarios:</p>
<pre><code>-Fish trophic positions are not variable among lakes?
-Fish trophic positions are similar within lakes but variable among lakes?</code></pre>
<p>++++ Challenge 2 Answer |</p>
<pre><code>-Low ICC smaller confidence intervals
-High ICC larger confidence intervals</code></pre>
<p>++++</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="fixed-and-random-effects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="how-do-i-implement-lmms-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
