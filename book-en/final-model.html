<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 Final model | Workshop 9: Multivariate Analyses in R</title>
  <meta name="description" content="Multivariate Analyses in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 Final model | Workshop 9: Multivariate Analyses in R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Multivariate Analyses in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 Final model | Workshop 9: Multivariate Analyses in R" />
  
  <meta name="twitter:description" content="Multivariate Analyses in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="random-intercepts.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Preparation for the workshop</b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="part"><span><b>Linear mixed models (LMMs)</b></span></li>
<li class="chapter" data-level="3" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>3</b> Overview</a></li>
<li class="chapter" data-level="4" data-path="what-is-a-lmm-and-why-should-i-care.html"><a href="what-is-a-lmm-and-why-should-i-care.html"><i class="fa fa-check"></i><b>4</b> What is a LMM and why should I care?</a></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-dataset.html"><a href="introduction-to-the-dataset.html"><i class="fa fa-check"></i><b>5</b> Introduction to the dataset</a></li>
<li class="chapter" data-level="6" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html"><i class="fa fa-check"></i><b>6</b> How do I analyze this dataset?</a><ul>
<li class="chapter" data-level="6.1" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#run-many-separate-analyses"><i class="fa fa-check"></i><b>6.1</b> Run many separate analyses</a></li>
<li class="chapter" data-level="6.2" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#run-one-lumped-analysis"><i class="fa fa-check"></i><b>6.2</b> Run one lumped analysis</a></li>
<li class="chapter" data-level="6.3" data-path="how-do-i-analyze-this-dataset.html"><a href="how-do-i-analyze-this-dataset.html#fit-a-lmm"><i class="fa fa-check"></i><b>6.3</b> Fit a LMM</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html"><i class="fa fa-check"></i><b>7</b> Fixed and Random Effects</a><ul>
<li class="chapter" data-level="7.1" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html#fixed-effect"><i class="fa fa-check"></i><b>7.1</b> Fixed effect</a></li>
<li class="chapter" data-level="7.2" data-path="fixed-and-random-effects.html"><a href="fixed-and-random-effects.html#random-effect"><i class="fa fa-check"></i><b>7.2</b> Random effect</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html"><i class="fa fa-check"></i><b>8</b> How do LMM’s work?</a><ul>
<li class="chapter" data-level="8.1" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html#intercepts-andor-slopes-are-allowed-to-vary-by-lake-and-species"><i class="fa fa-check"></i><b>8.1</b> Intercepts and/or slopes are allowed to vary by lake and species</a></li>
<li class="chapter" data-level="8.2" data-path="how-do-lmms-work.html"><a href="how-do-lmms-work.html#intercepts-slopes-and-associated-confidence-intervals-are-adjusted-to-account-for-the-structure-of-data"><i class="fa fa-check"></i><b>8.2</b> Intercepts, slopes, and associated confidence intervals are adjusted to account for the structure of data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html"><i class="fa fa-check"></i><b>9</b> How do I implement LMM’s in R?</a><ul>
<li class="chapter" data-level="9.1" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#the-mixed-model-protocol-in-r"><i class="fa fa-check"></i><b>9.1</b> The mixed model protocol in R:</a></li>
<li class="chapter" data-level="9.2" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#a-priori-model-building-and-data-exploration"><i class="fa fa-check"></i><b>9.2</b> A priori model building and data exploration</a></li>
<li class="chapter" data-level="9.3" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#coding-potential-models-and-model-selection"><i class="fa fa-check"></i><b>9.3</b> Coding potential models and model selection</a></li>
<li class="chapter" data-level="9.4" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#model-validation"><i class="fa fa-check"></i><b>9.4</b> Model validation</a></li>
<li class="chapter" data-level="9.5" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#interpreting-results-and-visualizing-the-model"><i class="fa fa-check"></i><b>9.5</b> Interpreting results and visualizing the model</a></li>
<li class="chapter" data-level="9.6" data-path="how-do-i-implement-lmms-in-r.html"><a href="how-do-i-implement-lmms-in-r.html#thought-experiment"><i class="fa fa-check"></i><b>9.6</b> Thought Experiment</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear mixed models (GLMMs)</b></span></li>
<li class="chapter" data-level="10" data-path="generalized-linear-mixed-models-glmms.html"><a href="generalized-linear-mixed-models-glmms.html"><i class="fa fa-check"></i><b>10</b> Generalized linear mixed models (GLMMs)</a></li>
<li class="chapter" data-level="11" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html"><i class="fa fa-check"></i><b>11</b> Structure in dataset</a><ul>
<li class="chapter" data-level="11.1" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#poisson-glmm"><i class="fa fa-check"></i><b>11.1</b> Poisson GLMM</a></li>
<li class="chapter" data-level="11.2" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#negative-binomial-poisson-gamma-glmm"><i class="fa fa-check"></i><b>11.2</b> Negative binomial (Poisson-gamma) GLMM</a></li>
<li class="chapter" data-level="11.3" data-path="structure-in-dataset.html"><a href="structure-in-dataset.html#poisson-lognormal-glmm"><i class="fa fa-check"></i><b>11.3</b> Poisson-lognormal GLMM</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="random-intercepts.html"><a href="random-intercepts.html"><i class="fa fa-check"></i><b>12</b> Random intercepts</a><ul>
<li class="chapter" data-level="12.1" data-path="random-intercepts.html"><a href="random-intercepts.html#parameter-plots"><i class="fa fa-check"></i><b>12.1</b> Parameter plots</a></li>
<li class="chapter" data-level="12.2" data-path="random-intercepts.html"><a href="random-intercepts.html#random-intercept-plots"><i class="fa fa-check"></i><b>12.2</b> Random intercept plots</a></li>
<li class="chapter" data-level="12.3" data-path="random-intercepts.html"><a href="random-intercepts.html#random-slopes"><i class="fa fa-check"></i><b>12.3</b> Random slopes</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="final-model.html"><a href="final-model.html"><i class="fa fa-check"></i><b>13</b> Final model</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="14" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>14</b> Summary</a></li>
<li class="chapter" data-level="15" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>15</b> Additional resources</a><ul>
<li class="chapter" data-level="15.1" data-path="additional-resources.html"><a href="additional-resources.html#lmm-textbooks"><i class="fa fa-check"></i><b>15.1</b> LMM Textbooks</a></li>
<li class="chapter" data-level="15.2" data-path="additional-resources.html"><a href="additional-resources.html#glmm-resources"><i class="fa fa-check"></i><b>15.2</b> GLMM resources</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>16</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 9: Multivariate Analyses in <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="final-model" class="section level1">
<h1><span class="header-section-number">Chapter 13</span> Final model</h1>
<p>We end this section on GLMM with the evaluation of the fixed effects. We
first code potential models and compare them using AICc.</p>
<pre class="{.rsplus|}"><code>mpl2 &lt;- update(mpl1, . ~ . - rack) # model without rack
mpl3 &lt;- update(mpl1, . ~ . - status) # model without status
mpl4 &lt;- update(mpl1, . ~ . - amd:nutrient) # without amd:nutrient interaction
ICtab(mpl1,mpl2,mpl3,mpl4, type = c(&quot;AICc&quot;))
#     dAICc df
# mpl1  0.0  10
# mpl4  1.4  9 
# mpl3  1.5  8 
# mpl2 55.0  9 </code></pre>
<p>Alternatively, we can use the functions <code>drop1</code> and <code>dfun</code>, where dfun
converts the AIC values returned by the drop1 into ΔAIC values
(producing a similar table to <code>ICtab</code> above).</p>
<pre class="{.rsplus|}"><code>(dd_LRT &lt;- drop1(mpl1,test=&quot;Chisq&quot;))
# Model:
#   total.fruits ~ nutrient * amd + rack + status + (1 | X) + (1 | popu) + (1 | gen)
#              Df    AIC   LRT   Pr(Chi)    
# &lt;none&gt;          5015.4                     
# rack          1 5070.5 57.083 4.179e-14 ***
# status        2 5017.0  5.612   0.06044 .  
# nutrient:amd  1 5016.8  3.444   0.06349 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(dd_AIC &lt;- dfun(drop1(mpl1)))
#               Df   dAIC
# &lt;none&gt;           0.000
# rack          1 55.083
# status        2  1.612
# nutrient:amd  1  1.444</code></pre>
<p>There is a strong effect of rack (a change in AIC of 55 if we remove
this variable), whereas the effects of status and of the interaction
term are weak (change in AIC when either is dropped is less than 2). We
can thus start by removing the non-signifi cant interaction term so that
we can test the main e ffects of nutrient and clipping.</p>
<pre class="{.rsplus|}"><code>mpl2 &lt;- update(mpl1, . ~ . - and:nutrient)

# Use AICc:
mpl3 &lt;- update(mpl2, . ~ . - rack) # model without rack or interaction
mpl4 &lt;- update(mpl2, . ~ . - status) # model without status or interaction
mpl5 &lt;- update(mpl2, . ~ . - nutrient) # without nutrient or interaction
mpl6 &lt;- update(mpl2, . ~ . - amd) # without clipping or interaction
ICtab(mpl2,mpl3,mpl4,mpl5,mpl6, type = c(&quot;AICc&quot;))
#     dAICc df
# mpl2   0.0 9 
# mpl4   1.2 7 
# mpl6  10.2 8 
# mpl3  54.2 8 
# mpl5 135.6 8 

# Or use drop1:
(dd_LRT2 &lt;- drop1(mpl2,test=&quot;Chisq&quot;))
# Model:
#   total.fruits ~ nutrient + amd + rack + status + (1 | X) + (1 | popu) + (1 | gen)
#            Df    AIC     LRT   Pr(Chi)    
#   &lt;none&gt;      5016.8                      
#   nutrient  1 5152.5 137.688 &lt; 2.2e-16 ***
#   amd       1 5027.0  12.218 0.0004734 ***
#   rack      1 5071.0  56.231 6.443e-14 ***
#   status    2 5018.1   5.286 0.0711639 .  
# ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(dd_AIC2 &lt;- dfun(drop1(mpl2)))
#           Df    dAIC
# &lt;none&gt;        0.000
# nutrient  1 135.688
# amd       1  10.218
# rack      1  54.231
# status    2   1.286

summary(mpl2)</code></pre>
<p>Both the main effects of nutrient and clipping are strong (large change
in AIC of 135.6 (mpl5) and 10.2 (mpl6) if either nutrient or clipping
are dropped, respectively). Our fi nal model includes the fixed nutrient
(strong positive) and clipping (negative) effects, the nuisance
variables rack, the observation-level random e ffects (1 | X) to
account for over-dispersion and the variation in overall fruit set at
the <em>population</em> and <em>genotype</em> levels.</p>
<p>** CHALLENGE 10 **</p>
<p>Using the <em>inverts</em> dataset (larval development times (PLD) of 74 marine
invertebrate and vertebrate species reared at different temperatures and
time), answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What is the effect of feeding type and climate (fixed effects) on
PLD?</li>
<li>Does this relationship vary among taxa (random effects)?</li>
<li>What is the best distribution family for this count data?</li>
<li>Finally, once you determined the best distribution family,
re-evaluate your random and fixed effects.</li>
</ol>
<p>++++ Challenge: Solution 1|</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="final-model.html#cb48-1"></a><span class="co"># Load data</span></span>
<span id="cb48-2"><a href="final-model.html#cb48-2"></a>inverts &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;inverts.csv&quot;</span>)</span>
<span id="cb48-3"><a href="final-model.html#cb48-3"></a><span class="kw">str</span>(inverts)</span>
<span id="cb48-4"><a href="final-model.html#cb48-4"></a></span>
<span id="cb48-5"><a href="final-model.html#cb48-5"></a>mlm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type, <span class="dt">data =</span> inverts)</span>
<span id="cb48-6"><a href="final-model.html#cb48-6"></a><span class="kw">anova</span>(mlm1)  <span class="co"># all variables are significant</span></span></code></pre></div>
<p>++++</p>
<p>++++ Challenge: Solution 2|</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="final-model.html#cb49-1"></a><span class="co"># Response vs fixed effects</span></span>
<span id="cb49-2"><a href="final-model.html#cb49-2"></a><span class="kw">ggplot</span>(inverts,<span class="kw">aes</span>(<span class="dt">x=</span>temp,<span class="dt">y=</span><span class="kw">log</span>(PLD<span class="op">+</span><span class="dv">1</span>),<span class="dt">colour=</span>feeding.type)) <span class="op">+</span></span>
<span id="cb49-3"><a href="final-model.html#cb49-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb49-4"><a href="final-model.html#cb49-4"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.numeric</span>(temp)),<span class="dt">fun.y=</span>mean,<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>) <span class="op">+</span></span>
<span id="cb49-5"><a href="final-model.html#cb49-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb49-6"><a href="final-model.html#cb49-6"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#3B9AB2&quot;</span>,<span class="st">&quot;#F21A00&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># from Wes Anderson Zissou palette</span></span>
<span id="cb49-7"><a href="final-model.html#cb49-7"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>taxon)</span>
<span id="cb49-8"><a href="final-model.html#cb49-8"></a></span>
<span id="cb49-9"><a href="final-model.html#cb49-9"></a><span class="co"># Create new variables that represents every combination feeding type x temp x taxa (random effect)</span></span>
<span id="cb49-10"><a href="final-model.html#cb49-10"></a>inverts &lt;-<span class="st"> </span><span class="kw">within</span>(inverts,</span>
<span id="cb49-11"><a href="final-model.html#cb49-11"></a>{</span>
<span id="cb49-12"><a href="final-model.html#cb49-12"></a>  <span class="co"># taxon x feeding.type</span></span>
<span id="cb49-13"><a href="final-model.html#cb49-13"></a>  tft &lt;-<span class="st"> </span><span class="kw">interaction</span>(taxon,feeding.type,temp)</span>
<span id="cb49-14"><a href="final-model.html#cb49-14"></a>  tft &lt;-<span class="st"> </span><span class="kw">reorder</span>(tft, PLD, mean)</span>
<span id="cb49-15"><a href="final-model.html#cb49-15"></a>})</span>
<span id="cb49-16"><a href="final-model.html#cb49-16"></a></span>
<span id="cb49-17"><a href="final-model.html#cb49-17"></a><span class="co"># Boxplot of total fruits vs new variable (feeding type x temp x taxa)</span></span>
<span id="cb49-18"><a href="final-model.html#cb49-18"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> inverts, <span class="kw">aes</span>(<span class="kw">factor</span>(<span class="dt">x =</span> tft),<span class="dt">y =</span> <span class="kw">log</span>(PLD))) <span class="op">+</span></span>
<span id="cb49-19"><a href="final-model.html#cb49-19"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;skyblue2&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">21</span>, <span class="dt">outlier.colour =</span> <span class="st">&quot;skyblue2&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-20"><a href="final-model.html#cb49-20"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-21"><a href="final-model.html#cb49-21"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p>++++</p>
<p>++++ Challenge: Solution 3|</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="final-model.html#cb50-1"></a>grpVars &lt;-<span class="st"> </span><span class="kw">tapply</span>(inverts<span class="op">$</span>PLD, inverts<span class="op">$</span>tft, var)</span>
<span id="cb50-2"><a href="final-model.html#cb50-2"></a><span class="kw">summary</span>(grpVars)</span>
<span id="cb50-3"><a href="final-model.html#cb50-3"></a></span>
<span id="cb50-4"><a href="final-model.html#cb50-4"></a>grpMeans &lt;-<span class="st"> </span><span class="kw">tapply</span>(inverts<span class="op">$</span>PLD, inverts<span class="op">$</span>tft, mean)</span>
<span id="cb50-5"><a href="final-model.html#cb50-5"></a><span class="kw">summary</span>(grpMeans)</span>
<span id="cb50-6"><a href="final-model.html#cb50-6"></a></span>
<span id="cb50-7"><a href="final-model.html#cb50-7"></a><span class="co"># Quasi-Poisson</span></span>
<span id="cb50-8"><a href="final-model.html#cb50-8"></a>lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb50-9"><a href="final-model.html#cb50-9"></a>phi.fit &lt;-<span class="st"> </span><span class="kw">coef</span>(lm1)</span>
<span id="cb50-10"><a href="final-model.html#cb50-10"></a><span class="co"># The -1 specifies a model with the intercept set to zero</span></span>
<span id="cb50-11"><a href="final-model.html#cb50-11"></a></span>
<span id="cb50-12"><a href="final-model.html#cb50-12"></a><span class="co"># Negative binomial</span></span>
<span id="cb50-13"><a href="final-model.html#cb50-13"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(grpVars <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(grpMeans<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">offset</span>(grpMeans) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb50-14"><a href="final-model.html#cb50-14"></a>k.fit &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="kw">coef</span>(lm2)</span>
<span id="cb50-15"><a href="final-model.html#cb50-15"></a><span class="co"># Offset() used to specify that we want group means added as</span></span>
<span id="cb50-16"><a href="final-model.html#cb50-16"></a><span class="co"># a term with its coefficient fixed to 1</span></span>
<span id="cb50-17"><a href="final-model.html#cb50-17"></a></span>
<span id="cb50-18"><a href="final-model.html#cb50-18"></a><span class="co"># Non-parametric loess fit</span></span>
<span id="cb50-19"><a href="final-model.html#cb50-19"></a>Lfit &lt;-<span class="st"> </span><span class="kw">loess</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans)</span>
<span id="cb50-20"><a href="final-model.html#cb50-20"></a></span>
<span id="cb50-21"><a href="final-model.html#cb50-21"></a><span class="kw">plot</span>(grpVars <span class="op">~</span><span class="st"> </span>grpMeans, <span class="dt">xlab =</span> <span class="st">&quot;group means&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;group variances&quot;</span>)</span>
<span id="cb50-22"><a href="final-model.html#cb50-22"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb50-23"><a href="final-model.html#cb50-23"></a><span class="kw">text</span>(<span class="dv">60</span>, <span class="dv">200</span>, <span class="st">&quot;Poisson&quot;</span>)</span>
<span id="cb50-24"><a href="final-model.html#cb50-24"></a><span class="kw">curve</span>(phi.fit <span class="op">*</span><span class="st"> </span>x, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb50-25"><a href="final-model.html#cb50-25"></a><span class="co"># bquote() is used to substitute numeric values in equations</span></span>
<span id="cb50-26"><a href="final-model.html#cb50-26"></a><span class="co"># with symbols</span></span>
<span id="cb50-27"><a href="final-model.html#cb50-27"></a><span class="kw">text</span>(<span class="dv">60</span>, <span class="dv">800</span>, <span class="kw">bquote</span>(<span class="kw">paste</span>(<span class="st">&quot;QP: &quot;</span>, sigma<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(phi.fit, </span>
<span id="cb50-28"><a href="final-model.html#cb50-28"></a>    <span class="dv">1</span>)) <span class="op">*</span><span class="st"> </span>mu)), <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb50-29"><a href="final-model.html#cb50-29"></a><span class="kw">curve</span>(x <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">/</span>k.fit), <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span>
<span id="cb50-30"><a href="final-model.html#cb50-30"></a><span class="kw">text</span>(<span class="dv">60</span>, <span class="dv">1600</span>, <span class="kw">paste</span>(<span class="st">&quot;NB: k=&quot;</span>, <span class="kw">round</span>(k.fit, <span class="dv">1</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>), <span class="dt">col =</span> <span class="dv">4</span>)</span>
<span id="cb50-31"><a href="final-model.html#cb50-31"></a>mvec &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">120</span></span>
<span id="cb50-32"><a href="final-model.html#cb50-32"></a><span class="kw">lines</span>(mvec, <span class="kw">predict</span>(Lfit, mvec), <span class="dt">col =</span> <span class="dv">5</span>)</span>
<span id="cb50-33"><a href="final-model.html#cb50-33"></a><span class="kw">text</span>(<span class="dv">50</span>, <span class="dv">1300</span>, <span class="st">&quot;loess&quot;</span>, <span class="dt">col =</span> <span class="dv">5</span>)</span>
<span id="cb50-34"><a href="final-model.html#cb50-34"></a></span>
<span id="cb50-35"><a href="final-model.html#cb50-35"></a><span class="co"># Poisson GLMM</span></span>
<span id="cb50-36"><a href="final-model.html#cb50-36"></a>mp1 &lt;-<span class="st"> </span><span class="kw">glmer</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>taxon), <span class="dt">data =</span> inverts, </span>
<span id="cb50-37"><a href="final-model.html#cb50-37"></a>    <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span>
<span id="cb50-38"><a href="final-model.html#cb50-38"></a><span class="kw">overdisp_fun</span>(mp1)</span>
<span id="cb50-39"><a href="final-model.html#cb50-39"></a><span class="co"># ratio is significantly &gt;1</span></span>
<span id="cb50-40"><a href="final-model.html#cb50-40"></a></span>
<span id="cb50-41"><a href="final-model.html#cb50-41"></a><span class="co"># NB GLMM</span></span>
<span id="cb50-42"><a href="final-model.html#cb50-42"></a>mnb1 &lt;-<span class="st"> </span><span class="kw">glmer.nb</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>taxon), <span class="dt">data =</span> inverts)</span>
<span id="cb50-43"><a href="final-model.html#cb50-43"></a><span class="kw">overdisp_fun</span>(mnb1)</span>
<span id="cb50-44"><a href="final-model.html#cb50-44"></a><span class="co"># Looks good!</span></span></code></pre></div>
<p>++++</p>
<p>++++ Challenge: Solution 4|</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="final-model.html#cb51-1"></a><span class="co"># Re-evaluating random intercepts</span></span>
<span id="cb51-2"><a href="final-model.html#cb51-2"></a><span class="kw">summary</span>(mnb1)<span class="op">$</span>varcor</span>
<span id="cb51-3"><a href="final-model.html#cb51-3"></a></span>
<span id="cb51-4"><a href="final-model.html#cb51-4"></a>mnb1.taxless &lt;-<span class="st"> </span><span class="kw">glm.nb</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type, <span class="dt">data =</span> inverts)</span>
<span id="cb51-5"><a href="final-model.html#cb51-5"></a><span class="co"># Here, because we are comparing a glmer with a glm, we must</span></span>
<span id="cb51-6"><a href="final-model.html#cb51-6"></a><span class="co"># do something different than calling anova() to test</span></span>
<span id="cb51-7"><a href="final-model.html#cb51-7"></a><span class="co"># importance of random intercept. We will compare the</span></span>
<span id="cb51-8"><a href="final-model.html#cb51-8"></a><span class="co"># likelihood of each model:</span></span>
<span id="cb51-9"><a href="final-model.html#cb51-9"></a>NL1 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">logLik</span>(mnb1)</span>
<span id="cb51-10"><a href="final-model.html#cb51-10"></a>NL0 &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">logLik</span>(mnb1.taxless)</span>
<span id="cb51-11"><a href="final-model.html#cb51-11"></a>devdiff &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(NL0 <span class="op">-</span><span class="st"> </span>NL1)</span>
<span id="cb51-12"><a href="final-model.html#cb51-12"></a>dfdiff &lt;-<span class="st"> </span><span class="kw">attr</span>(NL1, <span class="st">&quot;df&quot;</span>) <span class="op">-</span><span class="st"> </span><span class="kw">attr</span>(NL0, <span class="st">&quot;df&quot;</span>)</span>
<span id="cb51-13"><a href="final-model.html#cb51-13"></a><span class="kw">pchisq</span>(devdiff, dfdiff, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span>
<span id="cb51-14"><a href="final-model.html#cb51-14"></a></span>
<span id="cb51-15"><a href="final-model.html#cb51-15"></a><span class="co"># Could also look at dAIC to compare model with (mnb1) and</span></span>
<span id="cb51-16"><a href="final-model.html#cb51-16"></a><span class="co"># without (mnb1.taxless) random effects Using AICtab()</span></span>
<span id="cb51-17"><a href="final-model.html#cb51-17"></a><span class="co"># function</span></span>
<span id="cb51-18"><a href="final-model.html#cb51-18"></a><span class="kw">AICtab</span>(mnb1, mnb1.taxless)</span>
<span id="cb51-19"><a href="final-model.html#cb51-19"></a><span class="co"># Large change in AIC if drop random intercept. Therefore,</span></span>
<span id="cb51-20"><a href="final-model.html#cb51-20"></a><span class="co"># worth keeping this in.</span></span>
<span id="cb51-21"><a href="final-model.html#cb51-21"></a></span>
<span id="cb51-22"><a href="final-model.html#cb51-22"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb51-23"><a href="final-model.html#cb51-23"></a><span class="kw">locscaleplot</span>(mnb1)</span>
<span id="cb51-24"><a href="final-model.html#cb51-24"></a></span>
<span id="cb51-25"><a href="final-model.html#cb51-25"></a><span class="co"># Plotting variance terms</span></span>
<span id="cb51-26"><a href="final-model.html#cb51-26"></a><span class="kw">coefplot2</span>(mnb1, <span class="dt">ptype =</span> <span class="st">&quot;vcov&quot;</span>, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;Random effect variance&quot;</span>)</span>
<span id="cb51-27"><a href="final-model.html#cb51-27"></a></span>
<span id="cb51-28"><a href="final-model.html#cb51-28"></a><span class="co"># Plot of fixed effects</span></span>
<span id="cb51-29"><a href="final-model.html#cb51-29"></a><span class="kw">coefplot2</span>(mnb1, <span class="dt">intercept =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;Fixed effect coefficient&quot;</span>)</span>
<span id="cb51-30"><a href="final-model.html#cb51-30"></a></span>
<span id="cb51-31"><a href="final-model.html#cb51-31"></a><span class="co"># Plotting random intercepts</span></span>
<span id="cb51-32"><a href="final-model.html#cb51-32"></a>pp &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">layout.widths =</span> <span class="kw">list</span>(<span class="dt">left.padding =</span> <span class="dv">0</span>, <span class="dt">right.padding =</span> <span class="dv">0</span>))</span>
<span id="cb51-33"><a href="final-model.html#cb51-33"></a>r2 &lt;-<span class="st"> </span><span class="kw">ranef</span>(mnb1, <span class="dt">condVar =</span> <span class="ot">TRUE</span>)</span>
<span id="cb51-34"><a href="final-model.html#cb51-34"></a>d2 &lt;-<span class="st"> </span><span class="kw">dotplot</span>(r2, <span class="dt">par.settings =</span> pp)</span>
<span id="cb51-35"><a href="final-model.html#cb51-35"></a><span class="kw">grid.arrange</span>(d2<span class="op">$</span>taxon, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb51-36"><a href="final-model.html#cb51-36"></a></span>
<span id="cb51-37"><a href="final-model.html#cb51-37"></a><span class="co"># Evaluate random slopes</span></span>
<span id="cb51-38"><a href="final-model.html#cb51-38"></a>mnb2 &lt;-<span class="st"> </span><span class="kw">glmer.nb</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type <span class="op">+</span><span class="st"> </span>(PLD <span class="op">|</span><span class="st"> </span>taxon), <span class="dt">data =</span> inverts)</span>
<span id="cb51-39"><a href="final-model.html#cb51-39"></a></span>
<span id="cb51-40"><a href="final-model.html#cb51-40"></a><span class="co"># View variance-covariance components</span></span>
<span id="cb51-41"><a href="final-model.html#cb51-41"></a><span class="kw">summary</span>(mnb2)  <span class="co"># option 1</span></span>
<span id="cb51-42"><a href="final-model.html#cb51-42"></a><span class="kw">attr</span>(<span class="kw">VarCorr</span>(mnb2)<span class="op">$</span>taxon, <span class="st">&quot;correlation&quot;</span>)  <span class="co"># option 2</span></span>
<span id="cb51-43"><a href="final-model.html#cb51-43"></a><span class="kw">printvc</span>(mnb2)  <span class="co"># option 3</span></span>
<span id="cb51-44"><a href="final-model.html#cb51-44"></a><span class="co"># Strong correlation between random effects -&gt; not enough</span></span>
<span id="cb51-45"><a href="final-model.html#cb51-45"></a><span class="co"># power to test random slopes</span></span>
<span id="cb51-46"><a href="final-model.html#cb51-46"></a></span>
<span id="cb51-47"><a href="final-model.html#cb51-47"></a><span class="co"># Re-evaluating fixed effects Note: to run the drop1 we need</span></span>
<span id="cb51-48"><a href="final-model.html#cb51-48"></a><span class="co"># to speficy the theta parameter and run the NB model with</span></span>
<span id="cb51-49"><a href="final-model.html#cb51-49"></a><span class="co"># glmer:</span></span>
<span id="cb51-50"><a href="final-model.html#cb51-50"></a>theta.mnb1 &lt;-<span class="st"> </span><span class="kw">theta.md</span>(inverts<span class="op">$</span>PLD, <span class="kw">fitted</span>(mnb1), <span class="dt">dfr =</span> <span class="kw">df.residual</span>(mnb1))</span>
<span id="cb51-51"><a href="final-model.html#cb51-51"></a>mnb1 &lt;-<span class="st"> </span><span class="kw">glmer</span>(PLD <span class="op">~</span><span class="st"> </span>temp <span class="op">*</span><span class="st"> </span>feeding.type <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>taxon), <span class="dt">data =</span> inverts, </span>
<span id="cb51-52"><a href="final-model.html#cb51-52"></a>    <span class="dt">family =</span> <span class="kw">negative.binomial</span>(<span class="dt">theta =</span> theta.mnb1))</span>
<span id="cb51-53"><a href="final-model.html#cb51-53"></a></span>
<span id="cb51-54"><a href="final-model.html#cb51-54"></a>(dd_LRT &lt;-<span class="st"> </span><span class="kw">drop1</span>(mnb1, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>))</span>
<span id="cb51-55"><a href="final-model.html#cb51-55"></a>(dd_AIC &lt;-<span class="st"> </span><span class="kw">dfun</span>(<span class="kw">drop1</span>(mnb1)))</span>
<span id="cb51-56"><a href="final-model.html#cb51-56"></a><span class="co"># dAIC when feeding.type x temp interaction is dropped is</span></span>
<span id="cb51-57"><a href="final-model.html#cb51-57"></a><span class="co"># greater than 2, suggest to keep interaction in model</span></span></code></pre></div>
<p>++++</p>

</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="random-intercepts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
