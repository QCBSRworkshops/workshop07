<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 12 Analyse en coordonnées principales | Atelier 9 : Analyses multivariées en R</title>
  <meta name="description" content="Analyses multivariées en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 12 Analyse en coordonnées principales | Atelier 9 : Analyses multivariées en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Analyses multivariées en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 12 Analyse en coordonnées principales | Atelier 9 : Analyses multivariées en R" />
  
  <meta name="twitter:description" content="Analyses multivariées en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="analyse-des-correpondances.html"/>
<link rel="next" href="positionnement-multidimensionnel-non-métrique.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Analyses multivariées en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="quest-ce-que-lordination.html"><a href="quest-ce-que-lordination.html"><i class="fa fa-check"></i><b>3</b> Qu’est-ce que l’ordination?</a></li>
<li class="chapter" data-level="4" data-path="introduction-aux-données.html"><a href="introduction-aux-données.html"><i class="fa fa-check"></i><b>4</b> Introduction aux données</a></li>
<li class="chapter" data-level="5" data-path="exploration-des-données.html"><a href="exploration-des-données.html"><i class="fa fa-check"></i><b>5</b> 1. Exploration des données</a><ul>
<li class="chapter" data-level="5.1" data-path="exploration-des-données.html"><a href="exploration-des-données.html#données-sur-les-espèces"><i class="fa fa-check"></i><b>5.1</b> 1.1 Données sur les espèces</a></li>
<li class="chapter" data-level="5.2" data-path="exploration-des-données.html"><a href="exploration-des-données.html#données-sur-lenvironnement"><i class="fa fa-check"></i><b>5.2</b> 1.2 Données sur l’environnement</a></li>
</ul></li>
<li class="part"><span><b>Mesures d’association</b></span></li>
<li class="chapter" data-level="6" data-path="la-dissimilarité-des-données.html"><a href="la-dissimilarité-des-données.html"><i class="fa fa-check"></i><b>6</b> La (dis)similarité des données</a></li>
<li class="chapter" data-level="7" data-path="quantifier-la-dissimilarité-des-données.html"><a href="quantifier-la-dissimilarité-des-données.html"><i class="fa fa-check"></i><b>7</b> Quantifier la (dis)similarité des données</a><ul>
<li class="chapter" data-level="7.1" data-path="quantifier-la-dissimilarité-des-données.html"><a href="quantifier-la-dissimilarité-des-données.html#transformations-des-données-de-composition-des-communautés"><i class="fa fa-check"></i><b>7.1</b> Transformations des données de composition des communautés</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="groupement.html"><a href="groupement.html"><i class="fa fa-check"></i><b>8</b> Groupement</a></li>
<li class="part"><span><b>L’Ordination sans contrainte</b></span></li>
<li class="chapter" data-level="9" data-path="le-significat-de-lordination-sans-contrainte.html"><a href="le-significat-de-lordination-sans-contrainte.html"><i class="fa fa-check"></i><b>9</b> Le significat de l’ordination “sans contrainte”</a></li>
<li class="chapter" data-level="10" data-path="analyses-en-composantes-principales.html"><a href="analyses-en-composantes-principales.html"><i class="fa fa-check"></i><b>10</b> Analyses en Composantes Principales</a></li>
<li class="chapter" data-level="11" data-path="analyse-des-correpondances.html"><a href="analyse-des-correpondances.html"><i class="fa fa-check"></i><b>11</b> Analyse des Correpondances</a></li>
<li class="chapter" data-level="12" data-path="analyse-en-coordonnées-principales.html"><a href="analyse-en-coordonnées-principales.html"><i class="fa fa-check"></i><b>12</b> Analyse en coordonnées principales</a></li>
<li class="chapter" data-level="13" data-path="positionnement-multidimensionnel-non-métrique.html"><a href="positionnement-multidimensionnel-non-métrique.html"><i class="fa fa-check"></i><b>13</b> Positionnement multidimensionnel non-métrique</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="14" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>14</b> Sommaire</a></li>
<li class="chapter" data-level="15" data-path="resources-additionnels.html"><a href="resources-additionnels.html"><i class="fa fa-check"></i><b>15</b> Resources additionnels</a></li>
<li class="chapter" data-level="16" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>16</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 9 : Analyses multivariées en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="analyse-en-coordonnées-principales" class="section level1">
<h1><span class="header-section-number">Chapitre 12</span> Analyse en coordonnées principales</h1>
<p>La PCA, comme la CA, impose une préservation des distances entre objets:
la distance euclidienne dans le cas de la PCA, et la distance de Chi2
dans la CA. Si l’objectif est d’ordonner les objets sur la base d’une
autre mesure de distance plus appropriée au problème, la PCoA constitue
une technique de choix. Dans une PCA, les données sont pivotées de façon
à ce que la première composante principale (correspondant à une
combinaison linéaire des descripteurs) explique la plus forte proportion
de variation possible; la contribution de chaque descripteur (espèces ou
variables environnementales) à chaque composante principale peut alors
être évaluée d’après son score. La PCoA est une seconde méthode
d’ordination sans contrainte dans laquelle les points sont ajoutés les
uns après les autres à l’espace d’ordination en utilisant la distance
euclidienne <em>ou n’importe quelle mesure de distance (dissimilarité)
métrique vous choisissez</em>. Un premier point est ainsi placé dans
l’espèce d’ordination, puis un second point placé à la valeur de
distance du premier, puis un troisième et ainsi de suite en ajoutant
autant d’axes (de dimensions) que nécessaire. Il est parfois difficile
de choisir entre effectuer une PCA ou une PCoA. La PCA permet toutefois
de réduire des données multivariables en un faible nombre de dimensions
tandis que la PCoA est utile pour visualiser les distances entre sites
(ou objets). La PCoA est aussi particulièrement adaptées pour les jeux
de données présentant plus de colonnes que de lignes. Par exemple, si
des centaines d’espèces ont été observées dans un petit nombree de
quadrats, une approche basée sur une PCoA utilisant la distance de
Bray-Curtis (voir ci-dessous) peut être plus adaptée.</p>
<p>PCoA avec DoubsSpe (transformé Hellinger):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="analyse-en-coordonnées-principales.html#cb46-1"></a><span class="co"># En utilisant la fonction cmdscale()</span></span>
<span id="cb46-2"><a href="analyse-en-coordonnées-principales.html#cb46-2"></a>?cmdscale</span>
<span id="cb46-3"><a href="analyse-en-coordonnées-principales.html#cb46-3"></a><span class="kw">cmdscale</span>(<span class="kw">dist</span>(spe.hel), <span class="dt">k=</span>(<span class="kw">nrow</span>(spe)<span class="op">-</span><span class="dv">1</span>), <span class="dt">eig=</span><span class="ot">TRUE</span>)</span>
<span id="cb46-4"><a href="analyse-en-coordonnées-principales.html#cb46-4"></a></span>
<span id="cb46-5"><a href="analyse-en-coordonnées-principales.html#cb46-5"></a><span class="co"># En utilisant la fonction pcoa()</span></span>
<span id="cb46-6"><a href="analyse-en-coordonnées-principales.html#cb46-6"></a>?pcoa</span>
<span id="cb46-7"><a href="analyse-en-coordonnées-principales.html#cb46-7"></a>spe.h.pcoa&lt;-<span class="kw">pcoa</span>(<span class="kw">dist</span>(spe.hel))</span>
<span id="cb46-8"><a href="analyse-en-coordonnées-principales.html#cb46-8"></a></span>
<span id="cb46-9"><a href="analyse-en-coordonnées-principales.html#cb46-9"></a><span class="co"># Extraction des résultats</span></span>
<span id="cb46-10"><a href="analyse-en-coordonnées-principales.html#cb46-10"></a>spe.h.pcoa </span>
<span id="cb46-11"><a href="analyse-en-coordonnées-principales.html#cb46-11"></a></span>
<span id="cb46-12"><a href="analyse-en-coordonnées-principales.html#cb46-12"></a><span class="co"># Représentation graphique</span></span>
<span id="cb46-13"><a href="analyse-en-coordonnées-principales.html#cb46-13"></a><span class="kw">biplot.pcoa</span>(spe .h.pcoa, spe.hel, <span class="dt">dir.axis2=</span><span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<p>Les résultats de cette PCoA sont:</p>
<p><img src="images//pcoa_outputfr_1.png" width="800" /></p>
<p><img src="images//pcoa_outputfr_2.png" width="800" /></p>
<p>Et le graphique:</p>
<p><img src="images//pcoa_spe.png" width="500" /></p>
<p>Vous pouvez aussi exécuter cette PCoA avec une autre mesure de distance
(ex. Bray-Curtis):</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="analyse-en-coordonnées-principales.html#cb47-1"></a>spe.bray.pcoa &lt;-<span class="st"> </span><span class="kw">pcoa</span>(spe.db)  <span class="co"># il s&#39;agit de la matrice de distances de Bray-Curtis qu&#39;on a générée plus tôt </span></span>
<span id="cb47-2"><a href="analyse-en-coordonnées-principales.html#cb47-2"></a>spe.bray.pcoa</span>
<span id="cb47-3"><a href="analyse-en-coordonnées-principales.html#cb47-3"></a><span class="kw">biplot.pcoa</span>(spe.bray.pcoa, spe.hel, <span class="dt">dir.axis2 =</span> <span class="dv">-1</span>)</span>
<span id="cb47-4"><a href="analyse-en-coordonnées-principales.html#cb47-4"></a><span class="co"># Le choix d&#39;une mesure de distance est très important car ça</span></span>
<span id="cb47-5"><a href="analyse-en-coordonnées-principales.html#cb47-5"></a><span class="co"># influence les résultats!</span></span></code></pre></div>
<p><strong>Défi 5</strong> Exécuter une PCoA sur les données d’abondance des <em>espèces
d’acariens</em> transformées Hellinger (données mite). Quels sont les axes
importants? Quels groupes de sites pouvez-vous identifier? Quelles
espèces sont liées à chaque groupe de sites? Comment les résultats de
cette PCoA se comparent-ils avec ceux de la PCA?</p>
<p><strong>Défi 5 - Solution</strong></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="analyse-en-coordonnées-principales.html#cb48-1"></a>mite.spe.h.pcoa &lt;-<span class="st"> </span><span class="kw">pcoa</span>(<span class="kw">dist</span>(mite.spe.hel))</span>
<span id="cb48-2"><a href="analyse-en-coordonnées-principales.html#cb48-2"></a>mite.spe.h.pcoa</span>
<span id="cb48-3"><a href="analyse-en-coordonnées-principales.html#cb48-3"></a><span class="kw">windows</span>()</span>
<span id="cb48-4"><a href="analyse-en-coordonnées-principales.html#cb48-4"></a><span class="kw">biplot.pcoa</span>(mite.spe.h.pcoa, mite.spe.hel, <span class="dt">dir.axis2 =</span> <span class="dv">-1</span>)</span></code></pre></div>
<p>Représentation graphique:</p>
<p><img src="images//pcoa_mite.png" width="500" /></p>
<p>Les espèces 16 et 31 sont plus éloignées des autres espèces en termes de
distance, et donc leur distribution entre les sites est très différente
de celle des autres espèces d’acariens. Les sites dont les étiquettes
se chevauchent sont de bons exemples de sites à forte similarité en
termes de communautés d’acariens.</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="analyse-des-correpondances.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="positionnement-multidimensionnel-non-métrique.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
