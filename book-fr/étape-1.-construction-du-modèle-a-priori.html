<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 9 Étape 1. Construction du modèle a priori | Atelier 7: Modèles linéaires et généralisés linéaires mixtes</title>
  <meta name="description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 9 Étape 1. Construction du modèle a priori | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 9 Étape 1. Construction du modèle a priori | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  
  <meta name="twitter:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"/>
<link rel="next" href="étape-2.-coder-le-modèle.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires à effets mixtes (MLM) en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="pourquoi-choisir-un-mlm.html"><a href="pourquoi-choisir-un-mlm.html"><i class="fa fa-check"></i><b>3</b> Pourquoi choisir un MLM?</a></li>
<li class="chapter" data-level="4" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html"><i class="fa fa-check"></i><b>4</b> Commencer par une question</a>
<ul>
<li class="chapter" data-level="4.1" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html#défi-1"><i class="fa fa-check"></i><b>4.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analyse-des-données.html"><a href="analyse-des-données.html"><i class="fa fa-check"></i><b>5</b> Analyse des données</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-1-nombreuses-analyses-séparées"><i class="fa fa-check"></i><b>5.1</b> Option 1: Nombreuses analyses séparées</a></li>
<li class="chapter" data-level="5.2" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-2-une-analyse-groupée"><i class="fa fa-check"></i><b>5.2</b> Option 2: Une analyse groupée</a></li>
<li class="chapter" data-level="5.3" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-3-est-ce-quon-a-une-autre-option"><i class="fa fa-check"></i><b>5.3</b> Option 3: Est-ce qu’on a une autre option?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html"><i class="fa fa-check"></i><b>6</b> Effets fixes vs effets aléatoires</a>
<ul>
<li class="chapter" data-level="6.1" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-fixe-processus-déterministes"><i class="fa fa-check"></i><b>6.1</b> Effet fixe: processus déterministes</a></li>
<li class="chapter" data-level="6.2" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-aléatoire-processus-stochastiques"><i class="fa fa-check"></i><b>6.2</b> Effet aléatoire: processus stochastiques</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html"><i class="fa fa-check"></i><b>7</b> Comment fonctionnent les MLMs?</a>
<ul>
<li class="chapter" data-level="7.1" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#les-paramètres-peuvent-varier"><i class="fa fa-check"></i><b>7.1</b> Les paramètres peuvent varier</a>
<ul>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#ordonnée-à-lorigine"><i class="fa fa-check"></i>Ordonnée à l’origine:</a></li>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#pentes"><i class="fa fa-check"></i>Pentes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#tenir-compte-de-la-structure-des-données"><i class="fa fa-check"></i><b>7.2</b> Tenir compte de la structure des données</a></li>
<li class="chapter" data-level="7.3" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#défi-2"><i class="fa fa-check"></i><b>7.3</b> Défi 2</a></li>
</ul></li>
<li class="part"><span><b>Implémenter un MLM dans <code>R</code></b></span></li>
<li class="chapter" data-level="8" data-path="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><a href="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><i class="fa fa-check"></i><b>8</b> Le protocole pour implémenter des modèles à effets mixtes dans <code>R</code></a></li>
<li class="chapter" data-level="9" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html"><i class="fa fa-check"></i><b>9</b> Étape 1. Construction du modèle <em>a priori</em></a>
<ul>
<li class="chapter" data-level="9.1" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#exploration-des-données"><i class="fa fa-check"></i><b>9.1</b> Exploration des données</a></li>
<li class="chapter" data-level="9.2" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#vérifier-la-colinéarité"><i class="fa fa-check"></i><b>9.2</b> Vérifier la colinéarité</a></li>
<li class="chapter" data-level="9.3" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#défi-3"><i class="fa fa-check"></i><b>9.3</b> Défi 3</a></li>
<li class="chapter" data-level="9.4" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#considérez-léchelle"><i class="fa fa-check"></i><b>9.4</b> Considérez l’échelle</a></li>
<li class="chapter" data-level="9.5" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#avez-vous-besoin-dun-mlm"><i class="fa fa-check"></i><b>9.5</b> Avez-vous besoin d’un MLM?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html"><i class="fa fa-check"></i><b>10</b> Étape 2. Coder le modèle</a>
<ul>
<li class="chapter" data-level="10.1" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#note-sur-les-méthodes-destimation"><i class="fa fa-check"></i><b>10.1</b> Note sur les méthodes d’estimation</a></li>
<li class="chapter" data-level="10.2" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#différentes-structures-de-modèles"><i class="fa fa-check"></i><b>10.2</b> Différentes structures de modèles</a></li>
<li class="chapter" data-level="10.3" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#défi-4"><i class="fa fa-check"></i><b>10.3</b> Défi 4</a></li>
<li class="chapter" data-level="10.4" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#défi-5"><i class="fa fa-check"></i><b>10.4</b> Défi 5</a></li>
<li class="chapter" data-level="10.5" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#comparing-models"><i class="fa fa-check"></i><b>10.5</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html"><i class="fa fa-check"></i><b>11</b> Step 3. Validation du modèle</a>
<ul>
<li class="chapter" data-level="11.1" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-lhomogénéité-de-la-variance"><i class="fa fa-check"></i><b>11.1</b> 1. Vérifier l’homogénéité de la variance</a></li>
<li class="chapter" data-level="11.2" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-lindépendance-des-résidus"><i class="fa fa-check"></i><b>11.2</b> 2. Vérifier l’indépendance des résidus</a></li>
<li class="chapter" data-level="11.3" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-la-normalité"><i class="fa fa-check"></i><b>11.3</b> 3. Vérifier la normalité</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html"><i class="fa fa-check"></i><b>12</b> Step 4. Interprétation et visualisation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#interprétation-de-notre-modèle"><i class="fa fa-check"></i><b>12.1</b> Interprétation de notre modèle</a></li>
<li class="chapter" data-level="12.2" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-6"><i class="fa fa-check"></i><b>12.2</b> Défi 6</a></li>
<li class="chapter" data-level="12.3" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-7"><i class="fa fa-check"></i><b>12.3</b> Défi 7</a></li>
<li class="chapter" data-level="12.4" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-8"><i class="fa fa-check"></i><b>12.4</b> Défi 8</a></li>
</ul></li>
<li class="part"><span><b>Modèles Linéaires Généralisés Mixtes (GLMMs) en <code>R</code></b></span></li>
<li class="chapter" data-level="13" data-path="introduction-aux-glmm.html"><a href="introduction-aux-glmm.html"><i class="fa fa-check"></i><b>13</b> Introduction aux GLMM</a></li>
<li class="chapter" data-level="14" data-path="choisir-la-distribution-des-erreurs.html"><a href="choisir-la-distribution-des-erreurs.html"><i class="fa fa-check"></i><b>14</b> Choisir la distribution des erreurs</a></li>
<li class="chapter" data-level="15" data-path="glmm-poisson.html"><a href="glmm-poisson.html"><i class="fa fa-check"></i><b>15</b> GLMM Poisson</a></li>
<li class="chapter" data-level="16" data-path="glmm-binomiale-négative.html"><a href="glmm-binomiale-négative.html"><i class="fa fa-check"></i><b>16</b> GLMM binomiale négative</a></li>
<li class="chapter" data-level="17" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html"><i class="fa fa-check"></i><b>17</b> GLMM Poisson-lognormale</a>
<ul>
<li class="chapter" data-level="17.1" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#intercepts-aléatoires"><i class="fa fa-check"></i><b>17.1</b> Intercepts aléatoires</a></li>
<li class="chapter" data-level="17.2" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#représentation-graphique-des-paramètres-du-modèle"><i class="fa fa-check"></i><b>17.2</b> Représentation graphique des paramètres du modèle</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modèle-final.html"><a href="modèle-final.html"><i class="fa fa-check"></i><b>18</b> Modèle final</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modèle-final.html"><a href="modèle-final.html#défi-9"><i class="fa fa-check"></i><b>18.1</b> Défi 9</a></li>
</ul></li>
<li class="part"><span><b>Ressources additionnelles par LMM et GLMM</b></span></li>
<li class="chapter" data-level="19" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>19</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="20" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>20</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 7: Modèles linéaires et généralisés linéaires mixtes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="étape-1.-construction-du-modèle-a-priori" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapitre 9</span> Étape 1. Construction du modèle <em>a priori</em><a href="étape-1.-construction-du-modèle-a-priori.html#étape-1.-construction-du-modèle-a-priori" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Modèle basé sur connaissance <em>a priori</em>:</strong></p>
<p>Nous voulons déterminer si la position trophique peut être prédite par la longueur corporelle, tout en prenant en compte la variation entre les espèces et les lacs. Donc nous voulons un modèle qui ressemble à ceci:</p>
<p><span class="math display">\[PT_{ijk} \sim Longueur_i + Lac_j + Espèce_k + \epsilon_{ijk}\]</span>
où:</p>
<ul>
<li><span class="math inline">\(PT_{ijk}\)</span> est la position trophique du poisson (<span class="math inline">\(i\)</span>) du lac (<span class="math inline">\(j\)</span>) et de l’espèce (<span class="math inline">\(k\)</span>)</li>
<li><span class="math inline">\(\varepsilon\)</span> sont les résidus du modèle (c’est-à-dire la variation inexpliquée).</li>
</ul>
<div id="exploration-des-données" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Exploration des données<a href="étape-1.-construction-du-modèle-a-priori.html#exploration-des-données" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Les données ont-elles la bonne structure?</strong></p>
<p>Vérifiez la structure des données :</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifiez la structure des données</span></span>
<span id="cb7-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fish.data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    180 obs. of  4 variables:
##  $ Lake        : Factor w/ 6 levels &quot;L1&quot;,&quot;L2&quot;,&quot;L3&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Fish_Species: Factor w/ 3 levels &quot;S1&quot;,&quot;S2&quot;,&quot;S3&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Fish_Length : num  105 195 294 414 237 ...
##  $ Trophic_Pos : num  2.6 2.7 2.74 2.74 2.79 ...</code></pre>
<p>Observez maintenant la distribution des échantillons pour chaque facteur:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observez la distribution des échantillons pour chaque</span></span>
<span id="cb9-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># facteur:</span></span>
<span id="cb9-3"><a href="étape-1.-construction-du-modèle-a-priori.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(fish.data[, <span class="fu">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Fish_Species&quot;</span>)])</span></code></pre></div>
<pre><code>##     Fish_Species
## Lake S1 S2 S3
##   L1 10 10 10
##   L2 10 10 10
##   L3 10 10 10
##   L4 10 10 10
##   L5 10 10 10
##   L6 10 10 10</code></pre>
<p>Ce jeu de données est parfaitement équilibré, mais les <strong>modèles mixtes peuvent analyser des designs expérimentaux non équilibrés</strong>, comme c’est souvent le cas en écologie!</p>
<p>Regardez ensuite la distribution des variables continues:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regardez la distribution des variables continues.</span></span>
<span id="cb11-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fish.data<span class="sc">$</span>Fish_Length, <span class="at">xlab =</span> <span class="st">&quot;Length (mm)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb11-3"><a href="étape-1.-construction-du-modèle-a-priori.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fish.data<span class="sc">$</span>Trophic_Pos, <span class="at">xlab =</span> <span class="st">&quot;Trophic position&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-10-1.png" width="50%" /><img src="book-fr_files/figure-html/unnamed-chunk-10-2.png" width="50%" /></p>
<p>Des déviations majeures pourraient causer des problèmes d’hétéroscédasticité. Si nécessaire, faites des transformations. Dans ce cas-ci, <strong>les données semblent correctes</strong>.</p>
<hr />
</div>
<div id="vérifier-la-colinéarité" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Vérifier la colinéarité<a href="étape-1.-construction-du-modèle-a-priori.html#vérifier-la-colinéarité" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Vérifier la colinéarité entre vos variables explicatives</strong></p>
<p>Le problème avec les prédicteurs colinéaires est simplement qu’ils expliquent la même chose, alors leur effet sur la variable réponse sera confondu dans le modèle. Par défaut, le modèle attribuera beaucoup de pouvoir explicatif à la première variable du modèle et peu de pouvoir aux variables qui suivent.</p>
<p>Dans cet exemple, il n’y a pas de risque de colinéarité avec seulement une variable continue. Si vous aviez une autre variable continue (<code>Var2</code>), une façon simple de vérifier la colinéarité est <code>cor(var1, var2)</code></p>
<p>Voici un <a href="https://yetanotheriteration.netlify.app/2018/01/high-collinearity-effect-in-regressions/">exemple de colinéarité</a>.</p>
<hr />
</div>
<div id="défi-3" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Défi 3<a href="étape-1.-construction-du-modèle-a-priori.html#défi-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>C’est un problème de réflexion!</p>
<p>Quelles mesures supplémentaires aurions-nous pu prendre sur le terrain qui auraient pu être fortement corrélées avec la longueur corporelle?</p>
<hr />
<div id="défi-3-solution" class="section level4 unnumbered hasAnchor">
<h4><strong>Défi 3 Solution:</strong><a href="étape-1.-construction-du-modèle-a-priori.html#défi-3-solution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Il y a plusieurs réponses possibles ici.</p>
<p>Un exemple est la masse du poisson – c’est une variable fortement corrélée avec la longueur du poisson. Par conséquent, nous ne voulons pas inclure ces deux variables dans le même modèle.</p>
<hr />
</div>
</div>
<div id="considérez-léchelle" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Considérez l’échelle<a href="étape-1.-construction-du-modèle-a-priori.html#considérez-léchelle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Considérez l’échelle de vos données</strong></p>
<p>Si deux variables dans un même modèle ont des échelles très différentes, il est probable que le modèle indique <code>un problème de convergence</code> en essayant de calculer les paramètres.</p>
<p>La <a href="https://fr.wikipedia.org/wiki/Cote_Z_(statistiques)">correction Z</a> standardise les variables et résout ce problème (fonction <code>scale()</code> dans <code>R</code>) :</p>
<p><span class="math display">\[z = \frac{x-moyenne(x)}{écart.type(x)}\]</span></p>
<p>Considérez l’échelle des variables dans notre ensemble de données. La longueur corporelle est mesurée sur une <em>longue</em> échelle, tandis que la position trophique est mesurée sur une échelle qui est beaucoup plus courte.</p>
<p>Parce que nos données ont des échelles très différentes, on applique la <strong>correction Z</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Longueur corrigée, &#39;à la main&#39;</span></span>
<span id="cb12-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb12-2" aria-hidden="true" tabindex="-1"></a>fish.data<span class="sc">$</span>Z_Length <span class="ot">&lt;-</span> (fish.data<span class="sc">$</span>Fish_Length <span class="sc">-</span> <span class="fu">mean</span>(fish.data<span class="sc">$</span>Fish_Length))<span class="sc">/</span><span class="fu">sd</span>(fish.data<span class="sc">$</span>Fish_Length)</span>
<span id="cb12-3"><a href="étape-1.-construction-du-modèle-a-priori.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="étape-1.-construction-du-modèle-a-priori.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Position trophique corrigée, avec la fonction scale</span></span>
<span id="cb12-5"><a href="étape-1.-construction-du-modèle-a-priori.html#cb12-5" aria-hidden="true" tabindex="-1"></a>fish.data<span class="sc">$</span>Z_TP <span class="ot">&lt;-</span> <span class="fu">scale</span>(fish.data<span class="sc">$</span>Trophic_Pos)</span></code></pre></div>
<hr />
</div>
<div id="avez-vous-besoin-dun-mlm" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Avez-vous besoin d’un MLM?<a href="étape-1.-construction-du-modèle-a-priori.html#avez-vous-besoin-dun-mlm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Déterminez si vous avez besoin d’un modèle mixte</strong>.</p>
<p>Pour savoir si un modèle mixte est nécessaire pour vos données, vous devez déterminer s’il est important de prendre en compte l’effet aléatoire de facteurs qui pourraient influencer la relation qui vous intéresse (dans notre cas, lac et espèce).</p>
<p>Nous pouvons le faire en:</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>Créant un modèle linéaire sans les facteurs qui pourraient avoir un effet aléatoire</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Calculant les résidus de ce modèle linéaire</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Produisant un graphique de la valeur des résidus en fonction des niveaux des facteurs potentiellement aléatoires</li>
</ol></li>
</ul>
<p>Créer un modèle linéaire sans les facteurs</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb13-1" aria-hidden="true" tabindex="-1"></a>lm.test <span class="ot">&lt;-</span> <span class="fu">lm</span>(Z_TP <span class="sc">~</span> Z_Length, <span class="at">data =</span> fish.data)</span></code></pre></div>
<p>Calculer les résidus de ce modèle linéaire</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb14-1" aria-hidden="true" tabindex="-1"></a>lm.test.resid <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(lm.test)</span></code></pre></div>
<p>Représentez graphiquement la valeur des résidus en fonction des niveaux des facteurs</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.test.resid <span class="sc">~</span> <span class="fu">as.factor</span>(fish.data<span class="sc">$</span>Fish_Species), <span class="at">xlab =</span> <span class="st">&quot;Species&quot;</span>,</span>
<span id="cb15-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Standardized residuals&quot;</span>)</span>
<span id="cb15-3"><a href="étape-1.-construction-du-modèle-a-priori.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="étape-1.-construction-du-modèle-a-priori.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="étape-1.-construction-du-modèle-a-priori.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.test.resid <span class="sc">~</span> <span class="fu">as.factor</span>(fish.data<span class="sc">$</span>Lake), <span class="at">xlab =</span> <span class="st">&quot;Lake&quot;</span>,</span>
<span id="cb16-2"><a href="étape-1.-construction-du-modèle-a-priori.html#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Standardized residuals&quot;</span>)</span>
<span id="cb16-3"><a href="étape-1.-construction-du-modèle-a-priori.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="étape-1.-construction-du-modèle-a-priori.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<p>Les résidues semblent varier de façon non-aléatoire entre les espèces et entre les lacs. Ces patrons suggèrent qu’il y a de la variance résiduelle qui pourrait être expliquée par ces facteurs, et ils devraient donc être inclus dans le modèle!</p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="étape-2.-coder-le-modèle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
