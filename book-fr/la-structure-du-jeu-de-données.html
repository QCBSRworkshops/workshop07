<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 11 La structure du jeu de données | Atelier 9 : Analyses multivariées en R</title>
  <meta name="description" content="Analyses multivariées en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 11 La structure du jeu de données | Atelier 9 : Analyses multivariées en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Analyses multivariées en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 11 La structure du jeu de données | Atelier 9 : Analyses multivariées en R" />
  
  <meta name="twitter:description" content="Analyses multivariées en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="les-modèles-linéaires-généralisés-mixtes-glmm.html"/>
<link rel="next" href="intercepts-aléatoires.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Preparation pour l’atelier</b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="part"><span><b>Les modèles linéaires à effets mixtes (MLM)</b></span></li>
<li class="chapter" data-level="3" data-path="aperçu.html"><a href="aperçu.html"><i class="fa fa-check"></i><b>3</b> Aperçu</a></li>
<li class="chapter" data-level="4" data-path="quest-ce-quun-mlm-et-pourquoi-est-ce-important.html"><a href="quest-ce-quun-mlm-et-pourquoi-est-ce-important.html"><i class="fa fa-check"></i><b>4</b> Qu’est-ce qu’un MLM et pourquoi est-ce important?</a></li>
<li class="chapter" data-level="5" data-path="introduction-au-jeu-de-données.html"><a href="introduction-au-jeu-de-données.html"><i class="fa fa-check"></i><b>5</b> Introduction au jeu de données</a></li>
<li class="chapter" data-level="6" data-path="comment-pourrions-nous-analyser-ces-données.html"><a href="comment-pourrions-nous-analyser-ces-données.html"><i class="fa fa-check"></i><b>6</b> Comment pourrions-nous analyser ces données?</a><ul>
<li class="chapter" data-level="6.1" data-path="comment-pourrions-nous-analyser-ces-données.html"><a href="comment-pourrions-nous-analyser-ces-données.html#nombreuses-analyses-séparées"><i class="fa fa-check"></i><b>6.1</b> Nombreuses analyses séparées</a></li>
<li class="chapter" data-level="6.2" data-path="comment-pourrions-nous-analyser-ces-données.html"><a href="comment-pourrions-nous-analyser-ces-données.html#une-analyse-groupée"><i class="fa fa-check"></i><b>6.2</b> Une analyse groupée</a></li>
<li class="chapter" data-level="6.3" data-path="comment-pourrions-nous-analyser-ces-données.html"><a href="comment-pourrions-nous-analyser-ces-données.html#construire-un-mlm"><i class="fa fa-check"></i><b>6.3</b> Construire un MLM</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="effets-fixes-et-aléatoires.html"><a href="effets-fixes-et-aléatoires.html"><i class="fa fa-check"></i><b>7</b> Effets fixes et aléatoires</a><ul>
<li class="chapter" data-level="7.1" data-path="effets-fixes-et-aléatoires.html"><a href="effets-fixes-et-aléatoires.html#effet-fixe"><i class="fa fa-check"></i><b>7.1</b> Effet fixe</a></li>
<li class="chapter" data-level="7.2" data-path="effets-fixes-et-aléatoires.html"><a href="effets-fixes-et-aléatoires.html#effet-aléatoire"><i class="fa fa-check"></i><b>7.2</b> Effet aléatoire</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html"><i class="fa fa-check"></i><b>8</b> Comment fonctionnent les MLMs?</a><ul>
<li class="chapter" data-level="8.1" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#permettre-aux-intercepts-etou-pentes-de-varier-selon-le-lac-et-lespèce"><i class="fa fa-check"></i><b>8.1</b> Permettre aux intercepts et/ou pentes de varier selon le lac et l’espèce</a></li>
<li class="chapter" data-level="8.2" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#les-intercepts-pentes-et-intervalles-de-confiance-associés-sont-ajustés-pour-tenir-compte-de-la-structure-des-données"><i class="fa fa-check"></i><b>8.2</b> Les intercepts, pentes, et intervalles de confiance associés sont ajustés pour tenir compte de la structure des données</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html"><i class="fa fa-check"></i><b>9</b> Comment implémenter un MLM dans R?</a><ul>
<li class="chapter" data-level="9.1" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#le-protocole-des-modèles-mixtes-dans-r"><i class="fa fa-check"></i><b>9.1</b> Le protocole des modèles mixtes dans R:</a></li>
<li class="chapter" data-level="9.2" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#construction-du-modèle-a-priori-et-exploration-des-données"><i class="fa fa-check"></i><b>9.2</b> Construction du modèle a priori et exploration des données</a></li>
<li class="chapter" data-level="9.3" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#coder-les-modèles-potentiels-et-sélectionner-le-meilleur-modèle"><i class="fa fa-check"></i><b>9.3</b> Coder les modèles potentiels et sélectionner le meilleur modèle</a></li>
<li class="chapter" data-level="9.4" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#validation-du-modèle"><i class="fa fa-check"></i><b>9.4</b> Validation du modèle</a></li>
<li class="chapter" data-level="9.5" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#interpréter-les-résultats-et-les-visualiser-graphiquement"><i class="fa fa-check"></i><b>9.5</b> Interpréter les résultats et les visualiser graphiquement</a></li>
<li class="chapter" data-level="9.6" data-path="comment-implémenter-un-mlm-dans-r.html"><a href="comment-implémenter-un-mlm-dans-r.html#exercice-de-réflexion"><i class="fa fa-check"></i><b>9.6</b> Exercice de réflexion</a></li>
</ul></li>
<li class="part"><span><b>Les modèles linéaires généralisés mixtes (GLMM)</b></span></li>
<li class="chapter" data-level="10" data-path="les-modèles-linéaires-généralisés-mixtes-glmm.html"><a href="les-modèles-linéaires-généralisés-mixtes-glmm.html"><i class="fa fa-check"></i><b>10</b> Les modèles linéaires généralisés mixtes (GLMM)</a></li>
<li class="chapter" data-level="11" data-path="la-structure-du-jeu-de-données.html"><a href="la-structure-du-jeu-de-données.html"><i class="fa fa-check"></i><b>11</b> La structure du jeu de données</a><ul>
<li class="chapter" data-level="11.1" data-path="la-structure-du-jeu-de-données.html"><a href="la-structure-du-jeu-de-données.html#un-glmm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>11.1</b> Un GLMM avec une distribution de Poisson</a></li>
<li class="chapter" data-level="11.2" data-path="la-structure-du-jeu-de-données.html"><a href="la-structure-du-jeu-de-données.html#un-glmm-avec-un-distribution-binomiale-négative"><i class="fa fa-check"></i><b>11.2</b> Un GLMM avec un distribution binomiale négative</a></li>
<li class="chapter" data-level="11.3" data-path="la-structure-du-jeu-de-données.html"><a href="la-structure-du-jeu-de-données.html#un-glmm-avec-une-distribution-poisson-lognormal"><i class="fa fa-check"></i><b>11.3</b> Un GLMM avec une distribution "Poisson-lognormal"</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="intercepts-aléatoires.html"><a href="intercepts-aléatoires.html"><i class="fa fa-check"></i><b>12</b> Intercepts aléatoires</a><ul>
<li class="chapter" data-level="12.1" data-path="intercepts-aléatoires.html"><a href="intercepts-aléatoires.html#représentation-graphique-des-paramètres-du-modèle"><i class="fa fa-check"></i><b>12.1</b> Représentation graphique des paramètres du modèle</a></li>
<li class="chapter" data-level="12.2" data-path="intercepts-aléatoires.html"><a href="intercepts-aléatoires.html#graphiques-des-intercepts-aléatoires"><i class="fa fa-check"></i><b>12.2</b> Graphiques des intercepts aléatoires</a></li>
<li class="chapter" data-level="12.3" data-path="intercepts-aléatoires.html"><a href="intercepts-aléatoires.html#pentes-aléatoires"><i class="fa fa-check"></i><b>12.3</b> Pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="modèle-final.html"><a href="modèle-final.html"><i class="fa fa-check"></i><b>13</b> Modèle final</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="14" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>14</b> Summary</a></li>
<li class="chapter" data-level="15" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>15</b> Ressources additionnelles</a><ul>
<li class="chapter" data-level="15.1" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html#livres-de-référence-pour-les-mlms"><i class="fa fa-check"></i><b>15.1</b> Livres de référence pour les MLMs</a></li>
<li class="chapter" data-level="15.2" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html#ressources-pour-les-glmms"><i class="fa fa-check"></i><b>15.2</b> Ressources pour les GLMMs</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>16</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 9 : Analyses multivariées en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="la-structure-du-jeu-de-données" class="section level1">
<h1><span class="header-section-number">Chapitre 11</span> La structure du jeu de données</h1>
<p>Lorsque nous examinons l’interaction entre les éléments nutritifs et
l’herbivorie (clipping) à travers les neuf populations différentes,
nous constatons que le nombre de fruits est toujours plus élevé dans le
traitement élevé (High) en nutriments. L’effet de clipping est plus
faible, même que dans certaines populations nous notons une pente
négative.</p>
<pre class="{.rsplus|}"><code>ggplot(dat.tf,aes(x=amd,y=log(total.fruits+1),colour=nutrient)) +
  geom_point() + 
  stat_summary(aes(x= as.numeric(amd)),fun.y=mean,geom=&quot;line&quot;) +
  theme_bw() + theme(panel.margin=unit(0,&quot;lines&quot;)) +
  scale_color_manual(values=c(&quot;#3B9AB2&quot;,&quot;#F21A00&quot;)) + # de la palette Wes Anderson Zissou
  facet_wrap(~popu)</code></pre>
<p><img src="images//workshp_6_glmm_popu.png" class="align-center" width="600" /></p>
<p>Un graphique similaire peut être fait pour les 24 génotypes différents
(en changeant facet_wrap(~gen)).<br />
==== Choisir une distribution pour les résidus ====</p>
<p>La variable réponse représente des données d’occurrences, donc nous
devons choisir une distribution de Poisson pour modéliser cette
variable. Rappelez-vous qu’une propriété importante de la distribution
de Poisson est que la variance est égale à la moyenne. Cependant, comme
nous le verrons ci-dessous, la variance de chaque groupe augmente
beaucoup plus rapidement que la moyenne attendue sous la distribution de
Poisson.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="la-structure-du-jeu-de-données.html#cb33-1"></a><span class="co"># Créez de nouvelles variables qui représentent toutes les</span></span>
<span id="cb33-2"><a href="la-structure-du-jeu-de-données.html#cb33-2"></a><span class="co"># combinaisons de nutriments x facteur clipping x facteur</span></span>
<span id="cb33-3"><a href="la-structure-du-jeu-de-données.html#cb33-3"></a><span class="co"># aléatoire</span></span>
<span id="cb33-4"><a href="la-structure-du-jeu-de-données.html#cb33-4"></a>dat.tf &lt;-<span class="st"> </span><span class="kw">within</span>(dat.tf, {</span>
<span id="cb33-5"><a href="la-structure-du-jeu-de-données.html#cb33-5"></a>    <span class="co"># génotype x nutriments x clipping</span></span>
<span id="cb33-6"><a href="la-structure-du-jeu-de-données.html#cb33-6"></a>    gna &lt;-<span class="st"> </span><span class="kw">interaction</span>(gen, nutrient, amd)</span>
<span id="cb33-7"><a href="la-structure-du-jeu-de-données.html#cb33-7"></a>    gna &lt;-<span class="st"> </span><span class="kw">reorder</span>(gna, total.fruits, mean)</span>
<span id="cb33-8"><a href="la-structure-du-jeu-de-données.html#cb33-8"></a>    <span class="co"># population x nutriments x clipping</span></span>
<span id="cb33-9"><a href="la-structure-du-jeu-de-données.html#cb33-9"></a>    pna &lt;-<span class="st"> </span><span class="kw">interaction</span>(popu, nutrient, amd)</span>
<span id="cb33-10"><a href="la-structure-du-jeu-de-données.html#cb33-10"></a>    pna &lt;-<span class="st"> </span><span class="kw">reorder</span>(pna, total.fruits, mean)</span>
<span id="cb33-11"><a href="la-structure-du-jeu-de-données.html#cb33-11"></a>})</span>
<span id="cb33-12"><a href="la-structure-du-jeu-de-données.html#cb33-12"></a></span>
<span id="cb33-13"><a href="la-structure-du-jeu-de-données.html#cb33-13"></a></span>
<span id="cb33-14"><a href="la-structure-du-jeu-de-données.html#cb33-14"></a><span class="co"># Boîte à moustaches du total de fruits vs. nouvelle variable</span></span>
<span id="cb33-15"><a href="la-structure-du-jeu-de-données.html#cb33-15"></a><span class="co"># (génotype x nutriments x clipping)</span></span>
<span id="cb33-16"><a href="la-structure-du-jeu-de-données.html#cb33-16"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat.tf, <span class="kw">aes</span>(<span class="kw">factor</span>(<span class="dt">x =</span> gna), <span class="dt">y =</span> <span class="kw">log</span>(total.fruits <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-17"><a href="la-structure-du-jeu-de-données.html#cb33-17"></a><span class="st">    </span><span class="dv">1</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;skyblue2&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb33-18"><a href="la-structure-du-jeu-de-données.html#cb33-18"></a>    <span class="dt">outlier.colour =</span> <span class="st">&quot;skyblue2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-19"><a href="la-structure-du-jeu-de-données.html#cb33-19"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb33-20"><a href="la-structure-du-jeu-de-données.html#cb33-20"></a></span>
<span id="cb33-21"><a href="la-structure-du-jeu-de-données.html#cb33-21"></a><span class="co"># Boîte à moustaches du total des fruits vs. nouvelle</span></span>
<span id="cb33-22"><a href="la-structure-du-jeu-de-données.html#cb33-22"></a><span class="co"># variable (population x nutriments x clipping)</span></span>
<span id="cb33-23"><a href="la-structure-du-jeu-de-données.html#cb33-23"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dat.tf, <span class="kw">aes</span>(<span class="kw">factor</span>(<span class="dt">x =</span> pna), <span class="dt">y =</span> <span class="kw">log</span>(total.fruits <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-24"><a href="la-structure-du-jeu-de-données.html#cb33-24"></a><span class="st">    </span><span class="dv">1</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">colour =</span> <span class="st">&quot;skyblue2&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">21</span>, </span>
<span id="cb33-25"><a href="la-structure-du-jeu-de-données.html#cb33-25"></a>    <span class="dt">outlier.colour =</span> <span class="st">&quot;skyblue2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-26"><a href="la-structure-du-jeu-de-données.html#cb33-26"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="images/workshp_6_glmm_boxplot.png" class="align-center" width="750" />
<img src="images//workshop_6_glmm_boxplot_popu.png" class="align-center" width="750" /></p>
<p>Tel qu’illustré ci-dessus, il existe une importante hétérogénéité parmi
la variance de chaque groupe même lorsque la variable réponse est
transformée. Nous notons également que certains groupes ont une moyenne
et variance de zéro.</p>
<p>Pour identifier __la famille de distribution la plus appropriée __,
nous pouvons examiner un graphique de diagnostic de la variance de
chaque groupe par rapport à leurs moyennes. Nous présentons un exemple
ci-dessous pour le regroupement par génotype x nutriments x herbivore
(clipping).</p>
<ol style="list-style-type: decimal">
<li>Si nous observons une relation linéaire entre la variance et la
moyenne avec une pente = 1, une famille de <strong>Poisson</strong> serait
appropriée,</li>
<li>Si nous observons une relation moyenne-variance linéaire avec une
pente&gt; 1 (c. Var = φµ où φ &gt; 1), la famille <strong>quasi-Poisson</strong> (tel
que présenté ci-dessus) doit être utilisée,</li>
<li>Enfin, une relation quadratique entre la variance et la moyenne (c.
Var = µ(1 + α</li>
</ol>
<p>) ou µ(1 + µ/k)), est caractéristique des données surdispersées
résultant d’une hétérogénéité sous-jacente entre les échantillons. Dans
ce cas, la distribution <strong>binomiale négative</strong> (Poisson-gamma) serait
plus appropriée. <img src="images/worksp_6_error_dist.png" class="align-center" width="450" /></p>
<p>En examinant la figure ci-dessus, nous constatons qu’une distribution
quasi-Poisson linéaire peut être meilleure que la distribution binomiale
négative, mais nous aurions besoin de modélisation supplémentaire pour
le confirmer.</p>
<div id="un-glmm-avec-une-distribution-de-poisson" class="section level2">
<h2><span class="header-section-number">11.1</span> Un GLMM avec une distribution de Poisson</h2>
<p>On crée un GLMM en utilisant la fonction <code>glmer()</code> de la librairie
<em>lme4</em>. On spécifie le modèle avec un intercepte aléatoire pour les
facteurs génotype et population. Nous incluons les variables de nuisance
(rack et la méthode de germination) comme effets fixes. Compte tenu de
la relation entre la moyenne et la variance que nous avons observée
ci-dessus, nous aurons probablement besoin d’un modèle avec
surdispersion, mais nous allons commencer par un modèle avec une
distribution de Poisson.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="la-structure-du-jeu-de-données.html#cb34-1"></a>mp1 &lt;-<span class="st"> </span><span class="kw">glmer</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span><span class="st"> </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="la-structure-du-jeu-de-données.html#cb34-2"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>popu) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gen), <span class="dt">data =</span> dat.tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>)</span></code></pre></div>
<p>Nous pouvons vérifier la surdispersion en utilisant la fonction
<code>overdisp_fun</code> fournie par <a href="http://www.cell.com/cms/attachment/601623/4742452/mmc1.pdf">Bolker et al.
(2011)</a> qui
divise les résidus de Pearson par les degrés de liberté des résidus et
vérifie si les valeurs diffèrent de façon significative (i.e. si le
rapport entre la déviance et les degrés de liberté est significativement
différent de 1). Une faible valeur de p indique que les données sont
surdispersées (i.e. le ratio est significativement différent de 1).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="la-structure-du-jeu-de-données.html#cb35-1"></a><span class="co"># Surdispersion?</span></span>
<span id="cb35-2"><a href="la-structure-du-jeu-de-données.html#cb35-2"></a><span class="kw">overdisp_fun</span>(mp1)</span>
<span id="cb35-3"><a href="la-structure-du-jeu-de-données.html#cb35-3"></a></span>
<span id="cb35-4"><a href="la-structure-du-jeu-de-données.html#cb35-4"></a><span class="co"># On peut aussi l’estimer en divisant la déviance résiduelle</span></span>
<span id="cb35-5"><a href="la-structure-du-jeu-de-données.html#cb35-5"></a><span class="co"># par les degrés de liberté des résidus</span></span>
<span id="cb35-6"><a href="la-structure-du-jeu-de-données.html#cb35-6"></a><span class="kw">summary</span>(mp1)</span>
<span id="cb35-7"><a href="la-structure-du-jeu-de-données.html#cb35-7"></a><span class="co"># déviance résiduelle = 18253.7 and dl resid = 616</span></span></code></pre></div>
<p>Le ratio est &gt;&gt; 1, donc comme on s’y attendait, nous devons utiliser
une distribution différente où la variance augmente plus rapidement que
la moyenne, tels que la distribution binomiale négative.</p>
</div>
<div id="un-glmm-avec-un-distribution-binomiale-négative" class="section level2">
<h2><span class="header-section-number">11.2</span> Un GLMM avec un distribution binomiale négative</h2>
<p>Rappelez-vous que la distribution binomiale négative (ou Poisson-gamma)
satisfait la supposition que la variance est ** proportionnelle au
carré de la moyenne **.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="la-structure-du-jeu-de-données.html#cb36-1"></a><span class="co"># Note : Ce modèle converge si vous utilisez la version 3.0.2</span></span>
<span id="cb36-2"><a href="la-structure-du-jeu-de-données.html#cb36-2"></a><span class="co"># de R, mais peut ne pas converger avec des versions plus</span></span>
<span id="cb36-3"><a href="la-structure-du-jeu-de-données.html#cb36-3"></a><span class="co"># récentes. Si vous avez des problèmes de convergence,</span></span>
<span id="cb36-4"><a href="la-structure-du-jeu-de-données.html#cb36-4"></a><span class="co"># essayez le code suivant avec la version 3.0.2.</span></span>
<span id="cb36-5"><a href="la-structure-du-jeu-de-données.html#cb36-5"></a></span>
<span id="cb36-6"><a href="la-structure-du-jeu-de-données.html#cb36-6"></a>mnb1 &lt;-<span class="st"> </span><span class="kw">glmer.nb</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span><span class="st"> </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-7"><a href="la-structure-du-jeu-de-données.html#cb36-7"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>popu) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gen), <span class="dt">data =</span> dat.tf, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>))</span>
<span id="cb36-8"><a href="la-structure-du-jeu-de-données.html#cb36-8"></a><span class="co"># Le nouvel argument «control», bien qu’au-delà de la portée</span></span>
<span id="cb36-9"><a href="la-structure-du-jeu-de-données.html#cb36-9"></a><span class="co"># de cet atelier, spécifie la façon dont nous optimisons les</span></span>
<span id="cb36-10"><a href="la-structure-du-jeu-de-données.html#cb36-10"></a><span class="co"># valeurs des paramètres (c. en prenant la dérivée d&#39;une</span></span>
<span id="cb36-11"><a href="la-structure-du-jeu-de-données.html#cb36-11"></a><span class="co"># fonction ou en procédant par itération).  Si ce n’est pas</span></span>
<span id="cb36-12"><a href="la-structure-du-jeu-de-données.html#cb36-12"></a><span class="co"># possible de prendre la dérivée de la fonction, un</span></span>
<span id="cb36-13"><a href="la-structure-du-jeu-de-données.html#cb36-13"></a><span class="co"># algorithme itératif comme bobyqa (Bound Optimization BY</span></span>
<span id="cb36-14"><a href="la-structure-du-jeu-de-données.html#cb36-14"></a><span class="co"># Quadratic Approximation) est utilisé.</span></span>
<span id="cb36-15"><a href="la-structure-du-jeu-de-données.html#cb36-15"></a></span>
<span id="cb36-16"><a href="la-structure-du-jeu-de-données.html#cb36-16"></a><span class="co"># Surdispersion?</span></span>
<span id="cb36-17"><a href="la-structure-du-jeu-de-données.html#cb36-17"></a><span class="kw">overdisp_fun</span>(mnb1)</span></code></pre></div>
<p>Le rapport est maintenant beaucoup plus près de 1 (bien que la valeur p
est encore inférieur à 0,05).</p>
</div>
<div id="un-glmm-avec-une-distribution-poisson-lognormal" class="section level2">
<h2><span class="header-section-number">11.3</span> Un GLMM avec une distribution "Poisson-lognormal"</h2>
<p>Une autre option que nous n’avons pas encore décrit est la distribution
Poisson-lognormal. Cette approche aborde le problème de la surdispersion
en appliquant un effet aléatoire au niveau de l’observation (voir
<a href="https://peerj.com/articles/616.pdf">Harrison (2014)</a>), et modèle la
variation Poisson supplémentaire de la variable de réponse en utilisant
un effet aléatoire avec un niveau de chaque observation unique.</p>
<p>Un modèle Poisson-lognormal peut être construit en modélisant les ε<sub>i</sub>
avec une distribution a priori lognormal. Une distribution
Poisson-lognormal avec une moyenne µ et une variance a priori lognormal
σ<sup>2</sup> est donné par :</p>
<p>var(y) = µ + µ<sup>2</sup> <span class="math display">\[exp(σ^2^) - 1\]</span></p>
<p>En revanche, nous avons vu que la distribution binomiale négative
(Poisson-gamma) était donné par:</p>
<p>var(y) = µ + µ<sup>2</sup>/k</p>
<p>En générale, la variance σ<sup>2</sup> dans la distribution Poisson-lognormal
dépendra du niveau de regroupement que nous sélectionnons (i.e. au
niveau individuel, génotype ou de la population). Donc, le modèle de
Poisson-lognormal nous permet d’assigner l’agrégation observée à
différentes sources d’hétérogénéité. Ici, afin d’évaluer un effet
aléatoire au niveau de l’observation, nous allons l’évaluer au niveau
individuel.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="la-structure-du-jeu-de-données.html#cb37-1"></a>mpl1 &lt;-<span class="st"> </span><span class="kw">glmer</span>(total.fruits <span class="op">~</span><span class="st"> </span>nutrient <span class="op">*</span><span class="st"> </span>amd <span class="op">+</span><span class="st"> </span>rack <span class="op">+</span><span class="st"> </span>status <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-2"><a href="la-structure-du-jeu-de-données.html#cb37-2"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>X) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>popu) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>gen), <span class="dt">data =</span> dat.tf, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, </span>
<span id="cb37-3"><a href="la-structure-du-jeu-de-données.html#cb37-3"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>))</span>
<span id="cb37-4"><a href="la-structure-du-jeu-de-données.html#cb37-4"></a></span>
<span id="cb37-5"><a href="la-structure-du-jeu-de-données.html#cb37-5"></a><span class="kw">overdisp_fun</span>(mpl1)</span></code></pre></div>
<p>Nous avons réussi! Le rapport entre la déviance et les degrés de liberté
est maintenant conforme avec notre critère (en fait, il est plus //petit
// 1).</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="les-modèles-linéaires-généralisés-mixtes-glmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intercepts-aléatoires.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
