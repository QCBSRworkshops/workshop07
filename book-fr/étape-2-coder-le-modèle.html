<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 10 Étape 2. Coder le modèle | Atelier 7: Modèles linéaires et généralisés linéaires mixtes</title>
  <meta name="description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 10 Étape 2. Coder le modèle | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 10 Étape 2. Coder le modèle | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  
  <meta name="twitter:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="étape-1-construction-du-modèle-a-priori.html"/>
<link rel="next" href="step-3-validation-du-modèle.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires à effets mixtes (MLM) en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="pourquoi-choisir-un-mlm.html"><a href="pourquoi-choisir-un-mlm.html"><i class="fa fa-check"></i><b>3</b> Pourquoi choisir un MLM?</a></li>
<li class="chapter" data-level="4" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html"><i class="fa fa-check"></i><b>4</b> Commencer par une question</a><ul>
<li class="chapter" data-level="4.1" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html#défi-1"><i class="fa fa-check"></i><b>4.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analyse-des-données.html"><a href="analyse-des-données.html"><i class="fa fa-check"></i><b>5</b> Analyse des données</a><ul>
<li class="chapter" data-level="5.1" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-1-nombreuses-analyses-séparées"><i class="fa fa-check"></i><b>5.1</b> Option 1: Nombreuses analyses séparées</a></li>
<li class="chapter" data-level="5.2" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-2-une-analyse-groupée"><i class="fa fa-check"></i><b>5.2</b> Option 2: Une analyse groupée</a></li>
<li class="chapter" data-level="5.3" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-3-est-ce-quon-a-une-autre-option"><i class="fa fa-check"></i><b>5.3</b> Option 3: Est-ce qu’on a une autre option?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html"><i class="fa fa-check"></i><b>6</b> Effets fixes vs effets aléatoires</a><ul>
<li class="chapter" data-level="6.1" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-fixe-processus-déterministes"><i class="fa fa-check"></i><b>6.1</b> Effet fixe: processus déterministes</a></li>
<li class="chapter" data-level="6.2" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-aléatoire-processus-stochastiques"><i class="fa fa-check"></i><b>6.2</b> Effet aléatoire: processus stochastiques</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html"><i class="fa fa-check"></i><b>7</b> Comment fonctionnent les MLMs?</a><ul>
<li class="chapter" data-level="7.1" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#les-paramètres-peuvent-varier"><i class="fa fa-check"></i><b>7.1</b> Les paramètres peuvent varier</a><ul>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#ordonnée-à-lorigine"><i class="fa fa-check"></i>Ordonnée à l’origine:</a></li>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#pentes"><i class="fa fa-check"></i>Pentes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#tenir-compte-de-la-structure-des-données"><i class="fa fa-check"></i><b>7.2</b> Tenir compte de la structure des données</a></li>
<li class="chapter" data-level="7.3" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#défi-2"><i class="fa fa-check"></i><b>7.3</b> Défi 2</a></li>
</ul></li>
<li class="part"><span><b>Implémenter un MLM dans <code>R</code></b></span></li>
<li class="chapter" data-level="8" data-path="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><a href="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><i class="fa fa-check"></i><b>8</b> Le protocole pour implémenter des modèles à effets mixtes dans <code>R</code></a></li>
<li class="chapter" data-level="9" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html"><i class="fa fa-check"></i><b>9</b> Étape 1. Construction du modèle <em>a priori</em></a><ul>
<li class="chapter" data-level="9.1" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html#exploration-des-données"><i class="fa fa-check"></i><b>9.1</b> Exploration des données</a></li>
<li class="chapter" data-level="9.2" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html#vérifier-la-colinéarité"><i class="fa fa-check"></i><b>9.2</b> Vérifier la colinéarité</a></li>
<li class="chapter" data-level="9.3" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html#défi-3"><i class="fa fa-check"></i><b>9.3</b> Défi 3</a></li>
<li class="chapter" data-level="9.4" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html#considérez-léchelle"><i class="fa fa-check"></i><b>9.4</b> Considérez l’échelle</a></li>
<li class="chapter" data-level="9.5" data-path="étape-1-construction-du-modèle-a-priori.html"><a href="étape-1-construction-du-modèle-a-priori.html#avez-vous-besoin-dun-mlm"><i class="fa fa-check"></i><b>9.5</b> Avez-vous besoin d’un MLM?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html"><i class="fa fa-check"></i><b>10</b> Étape 2. Coder le modèle</a><ul>
<li class="chapter" data-level="10.1" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html#note-sur-les-méthodes-destimation"><i class="fa fa-check"></i><b>10.1</b> Note sur les méthodes d’estimation</a></li>
<li class="chapter" data-level="10.2" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html#différentes-structures-de-modèles"><i class="fa fa-check"></i><b>10.2</b> Différentes structures de modèles</a></li>
<li class="chapter" data-level="10.3" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html#défi-4"><i class="fa fa-check"></i><b>10.3</b> Défi 4</a></li>
<li class="chapter" data-level="10.4" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html#défi-5"><i class="fa fa-check"></i><b>10.4</b> Défi 5</a></li>
<li class="chapter" data-level="10.5" data-path="étape-2-coder-le-modèle.html"><a href="étape-2-coder-le-modèle.html#comparing-models"><i class="fa fa-check"></i><b>10.5</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="step-3-validation-du-modèle.html"><a href="step-3-validation-du-modèle.html"><i class="fa fa-check"></i><b>11</b> Step 3. Validation du modèle</a><ul>
<li class="chapter" data-level="11.1" data-path="step-3-validation-du-modèle.html"><a href="step-3-validation-du-modèle.html#vérifier-lhomogénéité-de-la-variance"><i class="fa fa-check"></i><b>11.1</b> 1. Vérifier l’homogénéité de la variance</a></li>
<li class="chapter" data-level="11.2" data-path="step-3-validation-du-modèle.html"><a href="step-3-validation-du-modèle.html#vérifier-lindépendance-des-résidus"><i class="fa fa-check"></i><b>11.2</b> 2. Vérifier l’indépendance des résidus</a></li>
<li class="chapter" data-level="11.3" data-path="step-3-validation-du-modèle.html"><a href="step-3-validation-du-modèle.html#vérifier-la-normalité"><i class="fa fa-check"></i><b>11.3</b> 3. Vérifier la normalité</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="step-4-interprétation-et-visualisation.html"><a href="step-4-interprétation-et-visualisation.html"><i class="fa fa-check"></i><b>12</b> Step 4. Interprétation et visualisation</a><ul>
<li class="chapter" data-level="12.1" data-path="step-4-interprétation-et-visualisation.html"><a href="step-4-interprétation-et-visualisation.html#interprétation-de-notre-modèle"><i class="fa fa-check"></i><b>12.1</b> Interprétation de notre modèle</a></li>
<li class="chapter" data-level="12.2" data-path="step-4-interprétation-et-visualisation.html"><a href="step-4-interprétation-et-visualisation.html#défi-6"><i class="fa fa-check"></i><b>12.2</b> Défi 6</a></li>
<li class="chapter" data-level="12.3" data-path="step-4-interprétation-et-visualisation.html"><a href="step-4-interprétation-et-visualisation.html#défi-7"><i class="fa fa-check"></i><b>12.3</b> Défi 7</a></li>
<li class="chapter" data-level="12.4" data-path="step-4-interprétation-et-visualisation.html"><a href="step-4-interprétation-et-visualisation.html#défi-8"><i class="fa fa-check"></i><b>12.4</b> Défi 8</a></li>
</ul></li>
<li class="part"><span><b>Modèles Linéaires Généralisés Mixtes (GLMMs) en <code>R</code></b></span></li>
<li class="chapter" data-level="13" data-path="introduction-aux-glmm.html"><a href="introduction-aux-glmm.html"><i class="fa fa-check"></i><b>13</b> Introduction aux GLMM</a></li>
<li class="chapter" data-level="14" data-path="choisir-la-distribution-des-erreurs.html"><a href="choisir-la-distribution-des-erreurs.html"><i class="fa fa-check"></i><b>14</b> Choisir la distribution des erreurs</a></li>
<li class="chapter" data-level="15" data-path="glmm-poisson.html"><a href="glmm-poisson.html"><i class="fa fa-check"></i><b>15</b> GLMM Poisson</a></li>
<li class="chapter" data-level="16" data-path="glmm-binomiale-négative.html"><a href="glmm-binomiale-négative.html"><i class="fa fa-check"></i><b>16</b> GLMM binomiale négative</a></li>
<li class="chapter" data-level="17" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html"><i class="fa fa-check"></i><b>17</b> GLMM Poisson-lognormale</a><ul>
<li class="chapter" data-level="17.1" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#intercepts-aléatoires"><i class="fa fa-check"></i><b>17.1</b> Intercepts aléatoires</a></li>
<li class="chapter" data-level="17.2" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#représentation-graphique-des-paramètres-du-modèle"><i class="fa fa-check"></i><b>17.2</b> Représentation graphique des paramètres du modèle</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modèle-final.html"><a href="modèle-final.html"><i class="fa fa-check"></i><b>18</b> Modèle final</a><ul>
<li class="chapter" data-level="18.1" data-path="modèle-final.html"><a href="modèle-final.html#défi-9"><i class="fa fa-check"></i><b>18.1</b> Défi 9</a></li>
</ul></li>
<li class="part"><span><b>Ressources additionnelles par LMM et GLMM</b></span></li>
<li class="chapter" data-level="19" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>19</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="20" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>20</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 7: Modèles linéaires et généralisés linéaires mixtes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="étape-2.-coder-le-modèle" class="section level1">
<h1><span class="header-section-number">Chapitre 10</span> Étape 2. Coder le modèle</h1>
<p><strong>Traduisons notre modèle…</strong></p>
<p><span class="math display">\[PT_{ijk} \sim Longueur_i + Lac_j + Espèce_k + \varepsilon_{ijk}\]</span></p>
<p><strong>… en code R</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="étape-2-coder-le-modèle.html#cb16-1"></a><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species), <span class="dt">data =</span> fish.data, </span>
<span id="cb16-2"><a href="étape-2-coder-le-modèle.html#cb16-2"></a>    <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: Z_TP ~ Z_Length + (1 | Lake) + (1 | Fish_Species)
##    Data: fish.data
## REML criterion at convergence: 72.4662
## Random effects:
##  Groups       Name        Std.Dev.
##  Lake         (Intercept) 0.4516  
##  Fish_Species (Intercept) 0.9301  
##  Residual                 0.2605  
## Number of obs: 180, groups:  Lake, 6; Fish_Species, 3
## Fixed Effects:
## (Intercept)     Z_Length  
##   9.752e-14    4.198e-01</code></pre>
<p>Où:</p>
<ul>
<li><code>lmer()</code> est la fonction “linear mixed model” du package <code>lme4</code></li>
<li><code>(1 | Lake)</code> indique que les ordonnées à l’origine peuvent varier entre les lacs</li>
<li><code>REML = TRUE</code> spécifie la méthode d’estimation</li>
</ul>
<div id="note-sur-les-méthodes-destimation" class="section level2">
<h2><span class="header-section-number">10.1</span> Note sur les méthodes d’estimation</h2>
<p>REML (<em>Restricted Maximum Likelihood</em>) est la méthode par défaut dans la fonction <code>lmer</code> (voir <code>?lmer</code>).</p>
<p>La méthode de maximum de vraisemblance (ML, pour <em>Maximum Likelihood</em>) sous-estime les variances du modèle par un facteur <span class="math inline">\((n-k) / n\)</span>, ou <span class="math inline">\(k\)</span> est le nombre d’effes fixes.</p>
<p>Les estimations REML peuvent être utilisées lorsque vous comparez des modèles ayant les mêmes effets fixes (c’est-à-dire des modèles imbriqués). Cependant, si vous comparez des modèles où les effets fixes diffèrent d’un modèle à l’autre, il est préférable d’utiliser le maximum de vraisemblance pour ajuster les paramètres car cette méthode ne dépend pas des coefficients des effets fixes. L’ajustement en utilisant le maximum de vraisemblance est fait en mettant <code>REML=FALSE</code> dans la commande lmer.</p>
<p>Consultez cet <a href="https://towardsdatascience.com/maximum-likelihood-ml-vs-reml-78cf79bef2cf">article</a> pour plus d’information sur la différence entre ML et REML.</p>
<p><strong>En résumé:</strong></p>
<ul>
<li><p><strong>REML</strong> pour comparer des modèles avec des <strong>effets aléatoires nichés</strong> et la même structure d’effets fixes</p></li>
<li><p><strong>ML</strong> pour comparer des modèles avec des <strong>effets fixes nichés</strong> et la même structure d’effets aléatoires</p></li>
<li><p><strong>ML</strong> pour comparer des modèles <strong>avec et sans effets aléatoires</strong></p></li>
</ul>
</div>
<div id="différentes-structures-de-modèles" class="section level2">
<h2><span class="header-section-number">10.2</span> Différentes structures de modèles</h2>
<p><strong>Comment faire si on souhaite que la pente puisse varier?</strong></p>
<p><img src="images/fig_22_w5.png" /></p>
<p><strong>Il y a différentes structures possibles pour le modèle:</strong></p>
<ul>
<li><p><code>(1 | Lake)</code> effet aléatoire par lac à l’ordonnée à l’origine</p></li>
<li><p><code>(1 + Z_Length | Lake)</code> effet aléatoire par lac à l’ordonnée à l’origine et la pente en réponse à la longueur corporelle (NB: (<code>Z_Length | Lake)</code> donne le même résultat)</p></li>
<li><p><code>(-1 + Z_Length | Lake)</code> pour avoir uniquement l’effet aléatoire sur la pente</p></li>
<li><p><code>(1 | Lake) + (1 | Species)</code> pour des effets aléatoires croisés</p></li>
<li><p><code>(1 | Lake:Fish_Species)</code> pour utiliser l’interaction entre 2 facteurs groupant</p></li>
<li><p>Si votre jeu de données inclus des effets nichés, vous pouvez utiliser <code>/</code> pour les déclarer, e.g. <code>(1 | facteur1 / facteur2)</code> si <code>facteur2</code> est niché dans <code>facteur1</code> (<a href="https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified">voir stack-exchange</a>)</p></li>
</ul>
</div>
<div id="défi-4" class="section level2">
<h2><span class="header-section-number">10.3</span> Défi 4</h2>
<p>Réécrivez le code suivant de façon à ce que les <strong>pentes</strong> de la relation position trophique en fonction de longueur corporelle <strong>varient par lac et par espèces</strong>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="étape-2-coder-le-modèle.html#cb18-1"></a><span class="co"># Défi 4: Réécrivez le code suivant de façon à ce que les</span></span>
<span id="cb18-2"><a href="étape-2-coder-le-modèle.html#cb18-2"></a><span class="co"># **pentes** de la relation position trophique en fonction de</span></span>
<span id="cb18-3"><a href="étape-2-coder-le-modèle.html#cb18-3"></a><span class="co"># longueur corporelle **varient par lac et par espèces**:</span></span>
<span id="cb18-4"><a href="étape-2-coder-le-modèle.html#cb18-4"></a><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species), <span class="dt">data =</span> fish.data, </span>
<span id="cb18-5"><a href="étape-2-coder-le-modèle.html#cb18-5"></a>    <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: Z_TP ~ Z_Length + (1 | Lake) + (1 | Fish_Species)
##    Data: fish.data
## REML criterion at convergence: 72.4662
## Random effects:
##  Groups       Name        Std.Dev.
##  Lake         (Intercept) 0.4516  
##  Fish_Species (Intercept) 0.9301  
##  Residual                 0.2605  
## Number of obs: 180, groups:  Lake, 6; Fish_Species, 3
## Fixed Effects:
## (Intercept)     Z_Length  
##   9.752e-14    4.198e-01</code></pre>
<hr />
<div id="défi-4-solution" class="section level4 unnumbered">
<h4><strong>Défi 4 Solution:</strong></h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="étape-2-coder-le-modèle.html#cb20-1"></a><span class="co"># Défi 4 Solution:</span></span>
<span id="cb20-2"><a href="étape-2-coder-le-modèle.html#cb20-2"></a><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Lake) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span></span>
<span id="cb20-3"><a href="étape-2-coder-le-modèle.html#cb20-3"></a><span class="st">    </span>Fish_Species), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: 
## Z_TP ~ Z_Length + (1 + Z_Length | Lake) + (1 + Z_Length | Fish_Species)
##    Data: fish.data
## REML criterion at convergence: 20.5786
## Random effects:
##  Groups       Name        Std.Dev. Corr 
##  Lake         (Intercept) 0.45279       
##               Z_Length    0.02378  -0.82
##  Fish_Species (Intercept) 0.93103       
##               Z_Length    0.15728  1.00 
##  Residual                 0.22341       
## Number of obs: 180, groups:  Lake, 6; Fish_Species, 3
## Fixed Effects:
## (Intercept)     Z_Length  
##  -0.0009025    0.4223738  
## optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</code></pre>
<hr />
</div>
</div>
<div id="défi-5" class="section level2">
<h2><span class="header-section-number">10.4</span> Défi 5</h2>
<p>Pour déterminer si vous avez construit le meilleur modèle mixte sur la base de vos connaissances préalables, vous devez comparer ce modèle <em>a priori</em> à d’autres modèles alternatifs.</p>
<p>Avec l’ensemble de données sur lequel vous travaillez, il existe plusieurs modèles alternatifs qui pourraient mieux s’adapter à vos données. Pour le défi 5, faites une liste de 7 modèles alternatifs qui pourraient être comparés à celui-ci:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="étape-2-coder-le-modèle.html#cb23-1"></a><span class="co"># Défi 5 : Faites une liste de 7 modèles alternatifs qui</span></span>
<span id="cb23-2"><a href="étape-2-coder-le-modèle.html#cb23-2"></a><span class="co"># pourraient être comparés à ce modèle initial:</span></span>
<span id="cb23-3"><a href="étape-2-coder-le-modèle.html#cb23-3"></a><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species), <span class="dt">data =</span> fish.data, </span>
<span id="cb23-4"><a href="étape-2-coder-le-modèle.html#cb23-4"></a>    <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: Z_TP ~ Z_Length + (1 | Lake) + (1 | Fish_Species)
##    Data: fish.data
## REML criterion at convergence: 72.4662
## Random effects:
##  Groups       Name        Std.Dev.
##  Lake         (Intercept) 0.4516  
##  Fish_Species (Intercept) 0.9301  
##  Residual                 0.2605  
## Number of obs: 180, groups:  Lake, 6; Fish_Species, 3
## Fixed Effects:
## (Intercept)     Z_Length  
##   9.752e-14    4.198e-01</code></pre>
<p><em>Notez: Si nous avions différents effets fixes entre les modèles ou un modèle sans effects aléatoires, nous aurions dû indiquer <code>REML = FALSE</code> pour les comparer avec une méthode de vraisemblance comme l’AIC.</em></p>
<hr />
<div id="défi-5-solution" class="section level4 unnumbered">
<h4><strong>Défi 5 Solution:</strong></h4>
<p>Nous allons aussi construire le <strong>modèle linéaire de base</strong> <code>lm()</code> parce qu’il est toujours utile de voir la variation dans les valeurs de AICc.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="étape-2-coder-le-modèle.html#cb25-1"></a><span class="co"># Solution du défi 5: Modèle linéaire de base</span></span>
<span id="cb25-2"><a href="étape-2-coder-le-modèle.html#cb25-2"></a>M0 &lt;-<span class="st"> </span><span class="kw">lm</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length, <span class="dt">data =</span> fish.data)</span></code></pre></div>
<p>A fin de comparer ce modèle aux LMMs, il est important de <strong>changer la méthode d’estimation en ML (<code>REML=FALSE</code>)</strong> pour tous les autres modèles car <code>lm()</code> n’utilise pas la même méthode d’estimation que <code>lmer()</code>.</p>
<p>Examinons les autres modèles que vous auriez pu écrire (notez <code>REML = FALSE</code>):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="étape-2-coder-le-modèle.html#cb26-1"></a><span class="co"># Solution du défi 5, autres modèles potentiels Notez que</span></span>
<span id="cb26-2"><a href="étape-2-coder-le-modèle.html#cb26-2"></a><span class="co"># REML = FALSE afin de comparer avec le modèle linéaire de</span></span>
<span id="cb26-3"><a href="étape-2-coder-le-modèle.html#cb26-3"></a><span class="co"># base où la méthode d&#39;estimation = ML.</span></span>
<span id="cb26-4"><a href="étape-2-coder-le-modèle.html#cb26-4"></a></span>
<span id="cb26-5"><a href="étape-2-coder-le-modèle.html#cb26-5"></a><span class="co"># Modele linéaire de base</span></span>
<span id="cb26-6"><a href="étape-2-coder-le-modèle.html#cb26-6"></a>M0 &lt;-<span class="st"> </span><span class="kw">lm</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length, <span class="dt">data =</span> fish.data)</span>
<span id="cb26-7"><a href="étape-2-coder-le-modèle.html#cb26-7"></a><span class="co"># modèle complet avec variation des ordonnées à l&#39;origine</span></span>
<span id="cb26-8"><a href="étape-2-coder-le-modèle.html#cb26-8"></a>M1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), </span>
<span id="cb26-9"><a href="étape-2-coder-le-modèle.html#cb26-9"></a>    <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb26-10"><a href="étape-2-coder-le-modèle.html#cb26-10"></a><span class="co"># modèle complet avec variation des ordonnées à l&#39;origine et</span></span>
<span id="cb26-11"><a href="étape-2-coder-le-modèle.html#cb26-11"></a><span class="co"># de pentes</span></span>
<span id="cb26-12"><a href="étape-2-coder-le-modèle.html#cb26-12"></a>M2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-13"><a href="étape-2-coder-le-modèle.html#cb26-13"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="étape-2-coder-le-modèle.html#cb28-1"></a><span class="co"># Pas d&#39;effet lac, les ordonnées à l&#39;origine varient par</span></span>
<span id="cb28-2"><a href="étape-2-coder-le-modèle.html#cb28-2"></a><span class="co"># espèces</span></span>
<span id="cb28-3"><a href="étape-2-coder-le-modèle.html#cb28-3"></a>M3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species), <span class="dt">data =</span> fish.data, </span>
<span id="cb28-4"><a href="étape-2-coder-le-modèle.html#cb28-4"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb28-5"><a href="étape-2-coder-le-modèle.html#cb28-5"></a><span class="co"># Pas d&#39;effet espèces, les ordonnées à l&#39;origine varient par</span></span>
<span id="cb28-6"><a href="étape-2-coder-le-modèle.html#cb28-6"></a><span class="co"># lac</span></span>
<span id="cb28-7"><a href="étape-2-coder-le-modèle.html#cb28-7"></a>M4 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb28-8"><a href="étape-2-coder-le-modèle.html#cb28-8"></a><span class="co"># Pas d&#39;effet de lac, les ordonnées à l&#39;origine et les pentes</span></span>
<span id="cb28-9"><a href="étape-2-coder-le-modèle.html#cb28-9"></a><span class="co"># varient par espèces</span></span>
<span id="cb28-10"><a href="étape-2-coder-le-modèle.html#cb28-10"></a>M5 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species), <span class="dt">data =</span> fish.data, </span>
<span id="cb28-11"><a href="étape-2-coder-le-modèle.html#cb28-11"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="étape-2-coder-le-modèle.html#cb30-1"></a><span class="co"># Pas d&#39;effet de l&#39;espèces, les ordonnées à l&#39;origine et les</span></span>
<span id="cb30-2"><a href="étape-2-coder-le-modèle.html#cb30-2"></a><span class="co"># pentes varient par lac</span></span>
<span id="cb30-3"><a href="étape-2-coder-le-modèle.html#cb30-3"></a>M6 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, </span>
<span id="cb30-4"><a href="étape-2-coder-le-modèle.html#cb30-4"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="étape-2-coder-le-modèle.html#cb32-1"></a><span class="co"># modèle complet, variation d&#39;ordonnée à l&#39;origine et pente</span></span>
<span id="cb32-2"><a href="étape-2-coder-le-modèle.html#cb32-2"></a><span class="co"># par lac</span></span>
<span id="cb32-3"><a href="étape-2-coder-le-modèle.html#cb32-3"></a>M7 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span></span>
<span id="cb32-4"><a href="étape-2-coder-le-modèle.html#cb32-4"></a><span class="st">    </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="étape-2-coder-le-modèle.html#cb34-1"></a><span class="co"># modèle complet, variation d&#39;ordonnée à l&#39;origine et pente</span></span>
<span id="cb34-2"><a href="étape-2-coder-le-modèle.html#cb34-2"></a><span class="co"># par espèces</span></span>
<span id="cb34-3"><a href="étape-2-coder-le-modèle.html#cb34-3"></a>M8 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-4"><a href="étape-2-coder-le-modèle.html#cb34-4"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<p><strong>Lorsqu’on ajuste des MLM avec <code>lmer()</code>, il est possible de faire face à certaines erreurs our avertissements comme:</strong></p>
<ul>
<li><p><code>boundary (singular) fit: see ?isSingular</code>, voir <a href="https://stats.stackexchange.com/questions/378939/dealing-with-singular-fit-in-mixed-models">cette discussion</a></p></li>
<li><p><code>Model failed to converge with max|grad| ...</code>, voir <a href="https://stats.stackexchange.com/questions/242109/model-failed-to-converge-warning-in-lmer">cette discussion</a></p></li>
</ul>
<p>Voici une <a href="https://rdrr.io/cran/lme4/man/troubleshooting.html">liste</a> de problèmes possibles et comment les résoudre.</p>
</div>
</div>
<div id="comparing-models" class="section level2">
<h2><span class="header-section-number">10.5</span> Comparing models</h2>
<p>Maintenant que nous avons une liste de modèles potentiels, nous voulons les comparer entre eux pour sélectionner celui(ceux) qui a(ont) le plus de pouvoir prédictif.</p>
<p>Les modèles peuvent être comparés en utilisant la fonction <code>AICc</code> provenant du package <code>MuMIn</code>. Le critère d’information Akaike (AIC) est une <strong>mesure de qualité du modèle</strong> pouvant être utilisée pour comparer les modèles.</p>
<p><code>AICc</code> corrige pour le biais créé par les faibles tailles d’échantillon.</p>
<p>Pour trouver la valeur AICc d’un modèle, utilisez:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="étape-2-coder-le-modèle.html#cb36-1"></a><span class="co"># Trouver la valeur AICc pour notre premier modèle (Modèle</span></span>
<span id="cb36-2"><a href="étape-2-coder-le-modèle.html#cb36-2"></a><span class="co"># linéaire de base) avec le paquet MuMIn</span></span>
<span id="cb36-3"><a href="étape-2-coder-le-modèle.html#cb36-3"></a>MuMIn<span class="op">::</span><span class="kw">AICc</span>(M1)</span></code></pre></div>
<pre><code>## [1] 77.30499</code></pre>
<p>Pour regrouper toutes les valeurs de l’AICc dans un seul tableau, utilisez <code>MuMIn::model.sel()</code> pour calculer l’AICc pour chaque modèle (avec d’autres sorties) et ensuite sélectionnez seulement les colonnes d’intérêt pour les imprimer dans un tableau.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="étape-2-coder-le-modèle.html#cb38-1"></a><span class="co"># Pour regrouper toutes les valeurs de l&#39;AICc dans un seul</span></span>
<span id="cb38-2"><a href="étape-2-coder-le-modèle.html#cb38-2"></a><span class="co"># tableau, utilisez `MuMIn::model.sel()` pour calculer l&#39;AICc</span></span>
<span id="cb38-3"><a href="étape-2-coder-le-modèle.html#cb38-3"></a><span class="co"># pour chaque modèle (avec d&#39;autres sorties) et ensuite</span></span>
<span id="cb38-4"><a href="étape-2-coder-le-modèle.html#cb38-4"></a><span class="co"># sélectionnez seulement les colonnes d&#39;intérêt pour les</span></span>
<span id="cb38-5"><a href="étape-2-coder-le-modèle.html#cb38-5"></a><span class="co"># imprimer dans un tableau.</span></span>
<span id="cb38-6"><a href="étape-2-coder-le-modèle.html#cb38-6"></a>AIC.table &lt;-<span class="st"> </span>MuMIn<span class="op">::</span><span class="kw">model.sel</span>(M0, M1, M2, M3, M4, M5, M6, M7, </span>
<span id="cb38-7"><a href="étape-2-coder-le-modèle.html#cb38-7"></a>    M8)</span>
<span id="cb38-8"><a href="étape-2-coder-le-modèle.html#cb38-8"></a><span class="co"># `df` est le degré de liberté `logLik` est le log de la</span></span>
<span id="cb38-9"><a href="étape-2-coder-le-modèle.html#cb38-9"></a><span class="co"># vraisemblance `delta` est la différence d&#39;AICc avec la</span></span>
<span id="cb38-10"><a href="étape-2-coder-le-modèle.html#cb38-10"></a><span class="co"># valeur la plus petite</span></span>
<span id="cb38-11"><a href="étape-2-coder-le-modèle.html#cb38-11"></a>(AIC.table &lt;-<span class="st"> </span>AIC.table[, <span class="kw">c</span>(<span class="st">&quot;df&quot;</span>, <span class="st">&quot;logLik&quot;</span>, <span class="st">&quot;AICc&quot;</span>, <span class="st">&quot;delta&quot;</span>)])</span></code></pre></div>
<pre><code>##    df      logLik      AICc      delta
## M8  7   -8.597929  31.84702   0.000000
## M2  9   -8.216019  35.49086   3.643839
## M1  5  -33.480080  77.30499  45.457965
## M7  7  -33.186374  81.02391  49.176890
## M5  6 -128.310995 269.10754 237.260517
## M3  4 -134.532965 277.29450 245.447480
## M4  4 -224.715763 457.66010 425.813076
## M6  6 -224.671201 461.82795 429.980930
## M0  3 -236.861362 479.85909 448.012065</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="étape-2-coder-le-modèle.html#cb40-1"></a><span class="co"># Pour plus d&#39;informations sur les autres sorties ou</span></span>
<span id="cb40-2"><a href="étape-2-coder-le-modèle.html#cb40-2"></a><span class="co"># résultats de la fonction model.sel(), roulez `?model.sel`.</span></span></code></pre></div>
<p>Où:</p>
<ul>
<li><code>df</code> montre les degrés de liberté</li>
<li><code>logLik</code> est le log de la vraisemblance</li>
<li><code>delta</code> est la différence d’AICc avec la valeur la plus petite</li>
</ul>
<p>Nous avons seulement affiché une partie des résultats retourné par la fonction <code>model.sel()</code>, voir <code>?model.sel</code> pour plus d’informations.</p>
<hr />
<p><strong>Que signifient ces valeurs d’AICc?</strong></p>
<ul>
<li>Le modèle avec le plus petit AICc a le plus grand pouvoir prédictif.</li>
<li>Souvent on considère que deux modèles à +/- 2 unités d’AICc de différence ont un pouvoir prédictif équivalent.</li>
<li>Examinons de plus proche M8 and M2. On peut exclure les autres modèles, car ils ont des AICc beaucoup plus élevés.</li>
</ul>
<p><em>Notez qu’on utilise maintenant REML (i.e. <code>REML=TRUE</code>) puisqu’on compare deux modèles avec des effets aléatoires nichés et avec la même structure d’effets fixes.</em></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="étape-2-coder-le-modèle.html#cb41-1"></a><span class="co"># Examinons de plus proche M8 and M2 (les autres modèlesont</span></span>
<span id="cb41-2"><a href="étape-2-coder-le-modèle.html#cb41-2"></a><span class="co"># des AICc beaucoup plus élevés) `REML = TRUE` parce qu&#39;on</span></span>
<span id="cb41-3"><a href="étape-2-coder-le-modèle.html#cb41-3"></a><span class="co"># compare deux modèles avec des effets aléatoires nichés et</span></span>
<span id="cb41-4"><a href="étape-2-coder-le-modèle.html#cb41-4"></a><span class="co"># avec la même structure d&#39;effets fixes</span></span>
<span id="cb41-5"><a href="étape-2-coder-le-modèle.html#cb41-5"></a>M8 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-6"><a href="étape-2-coder-le-modèle.html#cb41-6"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="étape-2-coder-le-modèle.html#cb43-1"></a>M2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-2"><a href="étape-2-coder-le-modèle.html#cb43-2"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="étape-2-coder-le-modèle.html#cb45-1"></a><span class="co"># Sortonz un tableau pour comparer M2 et M8</span></span>
<span id="cb45-2"><a href="étape-2-coder-le-modèle.html#cb45-2"></a>MuMIn<span class="op">::</span><span class="kw">model.sel</span>(M2, M8)[, <span class="kw">c</span>(<span class="st">&quot;df&quot;</span>, <span class="st">&quot;logLik&quot;</span>, <span class="st">&quot;AICc&quot;</span>, <span class="st">&quot;delta&quot;</span>)]</span></code></pre></div>
<pre><code>##    df    logLik     AICc    delta
## M8  7 -10.84011 36.33137 0.000000
## M2  9 -10.28932 39.63747 3.306098</code></pre>
<p>Le modèle <code>M8</code> semble être le meilleur modèle parmi ceux qu’on a testé!</p>
<hr />
<p><strong>Quelle est la structure du meilleur modèle?</strong></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="étape-2-coder-le-modèle.html#cb47-1"></a><span class="co"># Regardons à nouveau le meilleur modèle, quelle est sa</span></span>
<span id="cb47-2"><a href="étape-2-coder-le-modèle.html#cb47-2"></a><span class="co"># structure?</span></span>
<span id="cb47-3"><a href="étape-2-coder-le-modèle.html#cb47-3"></a>M8 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-4"><a href="étape-2-coder-le-modèle.html#cb47-4"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="étape-2-coder-le-modèle.html#cb49-1"></a><span class="co"># L&#39;ordonnée à l&#39;origine et l&#39;effet de la longueur sur la</span></span>
<span id="cb49-2"><a href="étape-2-coder-le-modèle.html#cb49-2"></a><span class="co"># position trophique peut varier selon l&#39;espèce de poissons,</span></span>
<span id="cb49-3"><a href="étape-2-coder-le-modèle.html#cb49-3"></a><span class="co"># mais seulement l&#39;ordonnée à l&#39;origine peut varier par lac</span></span></code></pre></div>
<p>L’ordonnée à l’origine et l’effet de la longueur sur la position trophique peut varier selon l’espèce de poissons, mais seulement l’ordonnée à l’origine peut varier par lac.</p>
<div class="two-col">
<p><img src="images/fig_9_w5.png" /><br />
<img src="images/fig_8_w5.png" /></p>
</div>
<p>Une fois que le meilleur modèle est sélectionné, il faut remettre la méthode d’estimation a <code>REML = TRUE</code>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="étape-2-coder-le-modèle.html#cb50-1"></a><span class="co"># Une fois que le meilleur modèle est sélectionné il faut</span></span>
<span id="cb50-2"><a href="étape-2-coder-le-modèle.html#cb50-2"></a><span class="co"># remettre la méthode d&#39;estimation a `REML = TRUE`</span></span>
<span id="cb50-3"><a href="étape-2-coder-le-modèle.html#cb50-3"></a>M8 &lt;-<span class="st"> </span><span class="kw">lmer</span>(Z_TP <span class="op">~</span><span class="st"> </span>Z_Length <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Z_Length <span class="op">|</span><span class="st"> </span>Fish_Species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb50-4"><a href="étape-2-coder-le-modèle.html#cb50-4"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Lake), <span class="dt">data =</span> fish.data, <span class="dt">REML =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="étape-1-construction-du-modèle-a-priori.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="step-3-validation-du-modèle.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
