<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 17 GLMM Poisson-lognormale | Atelier 7: Modèles linéaires et généralisés linéaires mixtes</title>
  <meta name="description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 17 GLMM Poisson-lognormale | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="github-repo" content="qcbsRworkshops/workshop09" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 17 GLMM Poisson-lognormale | Atelier 7: Modèles linéaires et généralisés linéaires mixtes" />
  
  <meta name="twitter:description" content="Modèles linéaires et généralisés linéaires mixtes" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="glmm-binomiale-négative.html"/>
<link rel="next" href="modèle-final.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires à effets mixtes (MLM) en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="pourquoi-choisir-un-mlm.html"><a href="pourquoi-choisir-un-mlm.html"><i class="fa fa-check"></i><b>3</b> Pourquoi choisir un MLM?</a></li>
<li class="chapter" data-level="4" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html"><i class="fa fa-check"></i><b>4</b> Commencer par une question</a>
<ul>
<li class="chapter" data-level="4.1" data-path="commencer-par-une-question.html"><a href="commencer-par-une-question.html#défi-1"><i class="fa fa-check"></i><b>4.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analyse-des-données.html"><a href="analyse-des-données.html"><i class="fa fa-check"></i><b>5</b> Analyse des données</a>
<ul>
<li class="chapter" data-level="5.1" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-1-nombreuses-analyses-séparées"><i class="fa fa-check"></i><b>5.1</b> Option 1: Nombreuses analyses séparées</a></li>
<li class="chapter" data-level="5.2" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-2-une-analyse-groupée"><i class="fa fa-check"></i><b>5.2</b> Option 2: Une analyse groupée</a></li>
<li class="chapter" data-level="5.3" data-path="analyse-des-données.html"><a href="analyse-des-données.html#option-3-est-ce-quon-a-une-autre-option"><i class="fa fa-check"></i><b>5.3</b> Option 3: Est-ce qu’on a une autre option?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html"><i class="fa fa-check"></i><b>6</b> Effets fixes vs effets aléatoires</a>
<ul>
<li class="chapter" data-level="6.1" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-fixe-processus-déterministes"><i class="fa fa-check"></i><b>6.1</b> Effet fixe: processus déterministes</a></li>
<li class="chapter" data-level="6.2" data-path="effets-fixes-vs-effets-aléatoires.html"><a href="effets-fixes-vs-effets-aléatoires.html#effet-aléatoire-processus-stochastiques"><i class="fa fa-check"></i><b>6.2</b> Effet aléatoire: processus stochastiques</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html"><i class="fa fa-check"></i><b>7</b> Comment fonctionnent les MLMs?</a>
<ul>
<li class="chapter" data-level="7.1" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#les-paramètres-peuvent-varier"><i class="fa fa-check"></i><b>7.1</b> Les paramètres peuvent varier</a>
<ul>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#ordonnée-à-lorigine"><i class="fa fa-check"></i>Ordonnée à l’origine:</a></li>
<li class="chapter" data-level="" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#pentes"><i class="fa fa-check"></i>Pentes</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#tenir-compte-de-la-structure-des-données"><i class="fa fa-check"></i><b>7.2</b> Tenir compte de la structure des données</a></li>
<li class="chapter" data-level="7.3" data-path="comment-fonctionnent-les-mlms.html"><a href="comment-fonctionnent-les-mlms.html#défi-2"><i class="fa fa-check"></i><b>7.3</b> Défi 2</a></li>
</ul></li>
<li class="part"><span><b>Implémenter un MLM dans <code>R</code></b></span></li>
<li class="chapter" data-level="8" data-path="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><a href="le-protocole-pour-implémenter-des-modèles-à-effets-mixtes-dans-r.html"><i class="fa fa-check"></i><b>8</b> Le protocole pour implémenter des modèles à effets mixtes dans <code>R</code></a></li>
<li class="chapter" data-level="9" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html"><i class="fa fa-check"></i><b>9</b> Étape 1. Construction du modèle <em>a priori</em></a>
<ul>
<li class="chapter" data-level="9.1" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#exploration-des-données"><i class="fa fa-check"></i><b>9.1</b> Exploration des données</a></li>
<li class="chapter" data-level="9.2" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#vérifier-la-colinéarité"><i class="fa fa-check"></i><b>9.2</b> Vérifier la colinéarité</a></li>
<li class="chapter" data-level="9.3" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#défi-3"><i class="fa fa-check"></i><b>9.3</b> Défi 3</a></li>
<li class="chapter" data-level="9.4" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#considérez-léchelle"><i class="fa fa-check"></i><b>9.4</b> Considérez l’échelle</a></li>
<li class="chapter" data-level="9.5" data-path="étape-1.-construction-du-modèle-a-priori.html"><a href="étape-1.-construction-du-modèle-a-priori.html#avez-vous-besoin-dun-mlm"><i class="fa fa-check"></i><b>9.5</b> Avez-vous besoin d’un MLM?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html"><i class="fa fa-check"></i><b>10</b> Étape 2. Coder le modèle</a>
<ul>
<li class="chapter" data-level="10.1" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#note-sur-les-méthodes-destimation"><i class="fa fa-check"></i><b>10.1</b> Note sur les méthodes d’estimation</a></li>
<li class="chapter" data-level="10.2" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#différentes-structures-de-modèles"><i class="fa fa-check"></i><b>10.2</b> Différentes structures de modèles</a></li>
<li class="chapter" data-level="10.3" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#défi-4"><i class="fa fa-check"></i><b>10.3</b> Défi 4</a></li>
<li class="chapter" data-level="10.4" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#défi-5"><i class="fa fa-check"></i><b>10.4</b> Défi 5</a></li>
<li class="chapter" data-level="10.5" data-path="étape-2.-coder-le-modèle.html"><a href="étape-2.-coder-le-modèle.html#comparing-models"><i class="fa fa-check"></i><b>10.5</b> Comparing models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html"><i class="fa fa-check"></i><b>11</b> Step 3. Validation du modèle</a>
<ul>
<li class="chapter" data-level="11.1" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-lhomogénéité-de-la-variance"><i class="fa fa-check"></i><b>11.1</b> 1. Vérifier l’homogénéité de la variance</a></li>
<li class="chapter" data-level="11.2" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-lindépendance-des-résidus"><i class="fa fa-check"></i><b>11.2</b> 2. Vérifier l’indépendance des résidus</a></li>
<li class="chapter" data-level="11.3" data-path="step-3.-validation-du-modèle.html"><a href="step-3.-validation-du-modèle.html#vérifier-la-normalité"><i class="fa fa-check"></i><b>11.3</b> 3. Vérifier la normalité</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html"><i class="fa fa-check"></i><b>12</b> Step 4. Interprétation et visualisation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#interprétation-de-notre-modèle"><i class="fa fa-check"></i><b>12.1</b> Interprétation de notre modèle</a></li>
<li class="chapter" data-level="12.2" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-6"><i class="fa fa-check"></i><b>12.2</b> Défi 6</a></li>
<li class="chapter" data-level="12.3" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-7"><i class="fa fa-check"></i><b>12.3</b> Défi 7</a></li>
<li class="chapter" data-level="12.4" data-path="step-4.-interprétation-et-visualisation.html"><a href="step-4.-interprétation-et-visualisation.html#défi-8"><i class="fa fa-check"></i><b>12.4</b> Défi 8</a></li>
</ul></li>
<li class="part"><span><b>Modèles Linéaires Généralisés Mixtes (GLMMs) en <code>R</code></b></span></li>
<li class="chapter" data-level="13" data-path="introduction-aux-glmm.html"><a href="introduction-aux-glmm.html"><i class="fa fa-check"></i><b>13</b> Introduction aux GLMM</a></li>
<li class="chapter" data-level="14" data-path="choisir-la-distribution-des-erreurs.html"><a href="choisir-la-distribution-des-erreurs.html"><i class="fa fa-check"></i><b>14</b> Choisir la distribution des erreurs</a></li>
<li class="chapter" data-level="15" data-path="glmm-poisson.html"><a href="glmm-poisson.html"><i class="fa fa-check"></i><b>15</b> GLMM Poisson</a></li>
<li class="chapter" data-level="16" data-path="glmm-binomiale-négative.html"><a href="glmm-binomiale-négative.html"><i class="fa fa-check"></i><b>16</b> GLMM binomiale négative</a></li>
<li class="chapter" data-level="17" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html"><i class="fa fa-check"></i><b>17</b> GLMM Poisson-lognormale</a>
<ul>
<li class="chapter" data-level="17.1" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#intercepts-aléatoires"><i class="fa fa-check"></i><b>17.1</b> Intercepts aléatoires</a></li>
<li class="chapter" data-level="17.2" data-path="glmm-poisson-lognormale.html"><a href="glmm-poisson-lognormale.html#représentation-graphique-des-paramètres-du-modèle"><i class="fa fa-check"></i><b>17.2</b> Représentation graphique des paramètres du modèle</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="modèle-final.html"><a href="modèle-final.html"><i class="fa fa-check"></i><b>18</b> Modèle final</a>
<ul>
<li class="chapter" data-level="18.1" data-path="modèle-final.html"><a href="modèle-final.html#défi-9"><i class="fa fa-check"></i><b>18.1</b> Défi 9</a></li>
</ul></li>
<li class="part"><span><b>Ressources additionnelles par LMM et GLMM</b></span></li>
<li class="chapter" data-level="19" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>19</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="20" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>20</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 7: Modèles linéaires et généralisés linéaires mixtes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="glmm-poisson-lognormale" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">Chapitre 17</span> GLMM Poisson-lognormale<a href="glmm-poisson-lognormale.html#glmm-poisson-lognormale" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Une deuxième option pour une distribution où la variance augmente plus rapidement avec la moyenne est la distribution <strong>Poisson-lognormale</strong>. Ce modèle place effectivement une priorité lognormale sur <span class="math inline">\(εi\)</span>.</p>
<p>Une distribution Poisson-lognormale avec une moyenne de <span class="math inline">\(µ\)</span> et une variance antérieure lognormale de <span class="math inline">\(σ2\)</span> a une variance:</p>
<p><span class="math inline">\(var(y) = µ + µ2 [exp(σ2) - 1]\)</span></p>
<p>En revanche, nous avons vu que la distribution binomiale négative (Poisson-gamma) était donné par:</p>
<p><span class="math inline">\(var(y) = µ + µ2/k\)</span></p>
<p>En générale, la variance <span class="math inline">\(σ2\)</span> dans la distribution Poisson-lognormal dépendra du niveau de regroupement que nous sélectionnons (i.e. au niveau individuel, génotype ou de la population). Donc, le modèle de Poisson-lognormal nous permet d’assigner l’agrégation observée à différentes sources d’hétérogénéité.</p>
<p>Pour mettre en œuvre le <strong>effet aléatoire au niveau de l’observation</strong>, nous allons l’évaluer au niveau individuel. Pour ce faire, il suffit de placer un <strong>effet aléatoire au niveau des observations</strong> dans la formule du modèle.</p>
<p>Voir Harrison (2014) pour plus de détails <a href="https://doi.org/10.7717/peerj.616" class="uri">https://doi.org/10.7717/peerj.616</a>.</p>
<p>Pour ce faire, nous créons tout d’abord une variable nommée <code>X</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="glmm-poisson-lognormale.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GLMM Poisson-lognormale</span></span>
<span id="cb83-2"><a href="glmm-poisson-lognormale.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="glmm-poisson-lognormale.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cette variable est déjà dans vos données &#39;dat.tf&#39;, mais</span></span>
<span id="cb83-4"><a href="glmm-poisson-lognormale.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># voici comment la créer.</span></span>
<span id="cb83-5"><a href="glmm-poisson-lognormale.html#cb83-5" aria-hidden="true" tabindex="-1"></a>dat.tf<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat.tf)</span></code></pre></div>
<p>On traite la surdispersion en ajoutant l’effet <code>(1|X)</code> dans la formule:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="glmm-poisson-lognormale.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tenir compte de la surdispersion</span></span>
<span id="cb84-2"><a href="glmm-poisson-lognormale.html#cb84-2" aria-hidden="true" tabindex="-1"></a>mpl1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(total.fruits <span class="sc">~</span> nutrient <span class="sc">*</span> amd <span class="sc">+</span> rack <span class="sc">+</span> status <span class="sc">+</span></span>
<span id="cb84-3"><a href="glmm-poisson-lognormale.html#cb84-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> X) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> popu) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen), <span class="at">data =</span> dat.tf, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb84-4"><a href="glmm-poisson-lognormale.html#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>))</span></code></pre></div>
<p>On teste finalement pour la présence de surdispersion:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="glmm-poisson-lognormale.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Surdispersion?</span></span>
<span id="cb85-2"><a href="glmm-poisson-lognormale.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">overdisp_fun</span>(mpl1)</span></code></pre></div>
<pre><code>##         chisq         ratio             p          logp 
##  1.775360e+02  2.886764e-01  1.000000e+00 -3.754786e-73</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="glmm-poisson-lognormale.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le rapport est maintenant conforme avec notre critère,</span></span>
<span id="cb87-2"><a href="glmm-poisson-lognormale.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># soit &lt; 1</span></span></code></pre></div>
<p><strong>Le rapport est maintenant conforme avec notre critère, soit &lt; 1!</strong></p>
<hr />
<div id="intercepts-aléatoires" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> Intercepts aléatoires<a href="glmm-poisson-lognormale.html#intercepts-aléatoires" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Maintenant que nous avons la distribution d’erreur appropriée, nous pouvons tester l’importance des interceptes aléatoires (pour population et génotype) en comparant des modèles nichés <strong>avec</strong> et <strong>sans</strong> les effets aléatoires d’intérêt en utilisant soit:</p>
<ul>
<li><p><em>1. L’approche théorique d’information (tel que le Critère d’Information d’Akaike; AIC)</em>, qui, comme nous l’avons vu apres examine plusieurs hypothèses concurrentes (modèles) simultanément pour identifier le modèle avec le pouvoir prédictif le plus élevé compte tenu des données. Nous allons encore une fois utiliser le AICc pour corriger les petites tailles d’échantillon.</p></li>
<li><p><em>2. L’approche fréquentiste (test d’hypothèse nulle traditionnelle)</em>, où deux modèles nichés sont comparés en utilisant le tests de rapport de vraisemblance de la fonction anova(). Il est important de noter qu’avec cette approche, nous testons une hypothèse nulle d’une variance de zéro, mais étant donné que nous ne pouvons pas avoir un écart négatif, nous testons le paramètre à la limite de sa région réalisable. Par conséquent, la valeur de p rapporté est environ le double de ce qu’elle devrait être (c. nous avons tronquée la moitié des valeurs possibles ; celles qui tombent en dessous de 0).</p></li>
</ul>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="glmm-poisson-lognormale.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># popu seulement</span></span>
<span id="cb88-2"><a href="glmm-poisson-lognormale.html#cb88-2" aria-hidden="true" tabindex="-1"></a>mpl1.popu <span class="ot">&lt;-</span> <span class="fu">glmer</span>(total.fruits <span class="sc">~</span> nutrient <span class="sc">*</span> amd <span class="sc">+</span> rack <span class="sc">+</span> status <span class="sc">+</span></span>
<span id="cb88-3"><a href="glmm-poisson-lognormale.html#cb88-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> X) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> popu), <span class="at">data =</span> dat.tf, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>,</span>
<span id="cb88-4"><a href="glmm-poisson-lognormale.html#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>))</span>
<span id="cb88-5"><a href="glmm-poisson-lognormale.html#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="glmm-poisson-lognormale.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gen seulement</span></span>
<span id="cb88-7"><a href="glmm-poisson-lognormale.html#cb88-7" aria-hidden="true" tabindex="-1"></a>mpl1.gen <span class="ot">&lt;-</span> <span class="fu">glmer</span>(total.fruits <span class="sc">~</span> nutrient <span class="sc">*</span> amd <span class="sc">+</span> rack <span class="sc">+</span> status <span class="sc">+</span></span>
<span id="cb88-8"><a href="glmm-poisson-lognormale.html#cb88-8" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> X) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> gen), <span class="at">data =</span> dat.tf, <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>))</span>
<span id="cb88-9"><a href="glmm-poisson-lognormale.html#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="glmm-poisson-lognormale.html#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Approche AICc</span></span>
<span id="cb88-11"><a href="glmm-poisson-lognormale.html#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ICtab</span>(mpl1, mpl1.popu, mpl1.gen, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;AICc&quot;</span>))</span></code></pre></div>
<pre><code>##           dAICc df
## mpl1       0.0  10
## mpl1.popu  2.0  9 
## mpl1.gen  16.1  9</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="glmm-poisson-lognormale.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Approche fréquentiste (Likelihood Ratio Test)</span></span>
<span id="cb90-2"><a href="glmm-poisson-lognormale.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mpl1, mpl1.popu)</span></code></pre></div>
<pre><code>## Data: dat.tf
## Models:
## mpl1.popu: total.fruits ~ nutrient * amd + rack + status + (1 | X) + (1 | popu)
## mpl1: total.fruits ~ nutrient * amd + rack + status + (1 | X) + (1 | popu) + (1 | gen)
##           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
## mpl1.popu    9 5017.4 5057.4 -2499.7   4999.4                       
## mpl1        10 5015.4 5059.8 -2497.7   4995.4 4.0639  1    0.04381 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="glmm-poisson-lognormale.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mpl1, mpl1.gen)</span></code></pre></div>
<pre><code>## Data: dat.tf
## Models:
## mpl1.gen: total.fruits ~ nutrient * amd + rack + status + (1 | X) + (1 | gen)
## mpl1: total.fruits ~ nutrient * amd + rack + status + (1 | X) + (1 | popu) + (1 | gen)
##          npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
## mpl1.gen    9 5031.5 5071.5 -2506.8   5013.5                         
## mpl1       10 5015.4 5059.8 -2497.7   4995.4 18.177  1  2.014e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notez que le modèle sans l’intercept aléatoire pour génotype est à moins de deux unités AICc du modèle complet, ce qui indique que les deux modèles sont tout aussi plausibles (i.e. peu de soutien pour inclure un intercept aléatoire pour le génotype). Toutefois, lorsque nous utilisons la comparaison de vraisemblance de modèles nichés (anova()), et corrigeons pour les valeurs p gonflés par un facteur de 2, nous trouvons que dans les deux cas, p &lt;0,05. <strong>Donc le modèle avec les deux effets aléatoires (mpl1) est sélectionné.</strong></p>
<hr />
</div>
<div id="représentation-graphique-des-paramètres-du-modèle" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Représentation graphique des paramètres du modèle<a href="glmm-poisson-lognormale.html#représentation-graphique-des-paramètres-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Maintenant que nous avons choisi notre modèle, visualisons les paramètres du modèle.</strong></p>
<p>Peut être obtenu en utilisant la fonction <code>coefplot2()</code>de la librairie <code>coefplot2</code>:</p>
<p><em>Notez: Cette librairie n’est pas sur le CRAN! On utilise la librairie <code>remotes</code> pour l’installer à partir de GitHub.</em></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="glmm-poisson-lognormale.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisons les paramètres du modèle</span></span>
<span id="cb94-2"><a href="glmm-poisson-lognormale.html#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="glmm-poisson-lognormale.html#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cette librairie n&#39;est pas sur le CRAN! On utilise la</span></span>
<span id="cb94-4"><a href="glmm-poisson-lognormale.html#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># librairie `remotes` pour l&#39;installer à partir de GitHub.</span></span>
<span id="cb94-5"><a href="glmm-poisson-lognormale.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;coefplot2&quot;</span>)) remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;palday/coefplot2&quot;</span>,</span>
<span id="cb94-6"><a href="glmm-poisson-lognormale.html#cb94-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subdir =</span> <span class="st">&quot;pkg&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: coefplot2</code></pre>
<pre><code>## Loading required package: coda</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="glmm-poisson-lognormale.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coefplot2)</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="glmm-poisson-lognormale.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets aléatoires</span></span>
<span id="cb98-2"><a href="glmm-poisson-lognormale.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot2</span>(mpl1, <span class="at">ptype =</span> <span class="st">&quot;vcov&quot;</span>, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Random effect variance&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Ici, nous pouvons voir que certains effets aléatoires présentent une plus grande variance que d’autres.</p>
<div class="explanation">
<p>La variance des effets aléatoires (σ2i) représente la variance moyenne des effets aléatoires du modèle. Puisque cette variance reflète la variance “moyenne” des effets aléatoires pour les modèles mixtes, elle est également appropriée pour les modèles avec des structures d’effets aléatoires plus complexes, comme les pentes aléatoires ou les effets aléatoires imbriqués.</p>
</div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="glmm-poisson-lognormale.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effets fixes</span></span>
<span id="cb99-2"><a href="glmm-poisson-lognormale.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coefplot2</span>(mpl1, <span class="at">intercept =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Fixed effect coefficient&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<div class="explanation">
<p>La variance des effets fixes (σ2f) est la variance de la matrice-multiplication β∗X (vecteur de paramètres par matrice de modèle)</p>
</div>
<p><em>Notez: Les barres d’erreur sont visibles seulement pour les effets fixes, car <code>glmer()</code> ne modélise pas d’incertitude pour les effets aléatoires.</em></p>
<hr />
<p><strong>Visualisation des effets aléatoires</strong></p>
<p>Vous pouvez extraire les effets aléatoires en utilisant la fonction <code>ranef()</code> et les tracer en utilisant un <code>dotplot()</code> de la librairie <code>lattice</code>.</p>
<p>On constate une variation <strong>inter-population</strong>:</p>
<ul>
<li>Les populations espagnoles (SP) ont des valeurs plus élevées que les populations suédoises (SW) et néerlandaises (NL)</li>
</ul>
<p>On constate une faible variation <strong>inter-génotype</strong> :</p>
<ul>
<li>Les différences entre les génotypes semblent induites par le génotype 34</li>
</ul>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="glmm-poisson-lognormale.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dotplot code</span></span>
<span id="cb100-2"><a href="glmm-poisson-lognormale.html#cb100-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">layout.widths =</span> <span class="fu">list</span>(<span class="at">left.padding =</span> <span class="dv">0</span>, <span class="at">right.padding =</span> <span class="dv">0</span>),</span>
<span id="cb100-3"><a href="glmm-poisson-lognormale.html#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">layout.heights =</span> <span class="fu">list</span>(<span class="at">top.padding =</span> <span class="dv">0</span>, <span class="at">bottom.padding =</span> <span class="dv">0</span>))</span>
<span id="cb100-4"><a href="glmm-poisson-lognormale.html#cb100-4" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mpl1, <span class="at">condVar =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-5"><a href="glmm-poisson-lognormale.html#cb100-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(r2, <span class="at">par.settings =</span> pp)</span>
<span id="cb100-6"><a href="glmm-poisson-lognormale.html#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="glmm-poisson-lognormale.html#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(d2<span class="sc">$</span>gen, d2<span class="sc">$</span>popu, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="glmm-binomiale-négative.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modèle-final.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
